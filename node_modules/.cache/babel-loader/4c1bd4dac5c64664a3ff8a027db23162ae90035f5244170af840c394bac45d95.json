{"ast":null,"code":"import axios from'axios';const api=axios.create({baseURL:'https://ifunnytest.loca.lt/api',timeout:10000,// Adicione esta configuração:\ntransformRequest:[(data,headers)=>{if(data instanceof FormData){// Remove Content-Type para FormData - deixe o navegador definir\ndelete headers['Content-Type'];return data;}return data;}]});// Interceptor de requisição\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=`Bearer ${token}`;}return config;},error=>{return Promise.reject(error);});// Interceptor de resposta\napi.interceptors.response.use(response=>{// Garante que a resposta tenha uma estrutura consistente\nif(response.data===undefined){return{...response,data:null};}return response;},async error=>{var _error$response,_error$response2,_error$response2$data,_error$response3,_error$response4;// Tratamento de erros 401 (Não autorizado)\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){localStorage.removeItem('token');localStorage.removeItem('user');// Evita redirecionamento duplo\nif(!window.location.pathname.includes('/login')){window.location.href='/login';}}// Padroniza a estrutura de erro\nconst apiError={message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Erro na requisição',status:((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status)||500,data:((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data)||null};return Promise.reject(apiError);});// Função auxiliar para garantir que os dados sejam sempre um array\nconst ensureArrayData=data=>{if(Array.isArray(data))return data;if(data&&Array.isArray(data.data))return data.data;if(data&&data.items&&Array.isArray(data.items))return data.items;return[];};// Adiciona métodos personalizados\napi.getArray=async(url,config)=>{const response=await api.get(url,config);return ensureArrayData(response.data);};export default api;","map":{"version":3,"names":["axios","api","create","baseURL","timeout","transformRequest","data","headers","FormData","interceptors","request","use","config","token","localStorage","getItem","Authorization","error","Promise","reject","response","undefined","_error$response","_error$response2","_error$response2$data","_error$response3","_error$response4","status","removeItem","window","location","pathname","includes","href","apiError","message","ensureArrayData","Array","isArray","items","getArray","url","get"],"sources":["C:/Users/drrod/OneDrive/Área de Trabalho/client2/src/services/api.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst api = axios.create({\r\n  baseURL: 'https://ifunnytest.loca.lt/api',\r\n  timeout: 10000,\r\n  // Adicione esta configuração:\r\n  transformRequest: [(data, headers) => {\r\n    if (data instanceof FormData) {\r\n      // Remove Content-Type para FormData - deixe o navegador definir\r\n      delete headers['Content-Type'];\r\n      return data;\r\n    }\r\n    return data;\r\n  }]\r\n});\r\n\r\n// Interceptor de requisição\r\napi.interceptors.request.use(config => {\r\n  const token = localStorage.getItem('token');\r\n  if (token) {\r\n    config.headers.Authorization = `Bearer ${token}`;\r\n  }\r\n  return config;\r\n}, error => {\r\n  return Promise.reject(error);\r\n});\r\n\r\n// Interceptor de resposta\r\napi.interceptors.response.use(\r\n  response => {\r\n    // Garante que a resposta tenha uma estrutura consistente\r\n    if (response.data === undefined) {\r\n      return { ...response, data: null };\r\n    }\r\n    return response;\r\n  },\r\n  async error => {\r\n    // Tratamento de erros 401 (Não autorizado)\r\n    if (error.response?.status === 401) {\r\n      localStorage.removeItem('token');\r\n      localStorage.removeItem('user');\r\n      \r\n      // Evita redirecionamento duplo\r\n      if (!window.location.pathname.includes('/login')) {\r\n        window.location.href = '/login';\r\n      }\r\n    }\r\n\r\n    // Padroniza a estrutura de erro\r\n    const apiError = {\r\n      message: error.response?.data?.message || 'Erro na requisição',\r\n      status: error.response?.status || 500,\r\n      data: error.response?.data || null,\r\n    };\r\n\r\n    return Promise.reject(apiError);\r\n  }\r\n);\r\n\r\n// Função auxiliar para garantir que os dados sejam sempre um array\r\nconst ensureArrayData = (data) => {\r\n  if (Array.isArray(data)) return data;\r\n  if (data && Array.isArray(data.data)) return data.data;\r\n  if (data && data.items && Array.isArray(data.items)) return data.items;\r\n  return [];\r\n};\r\n\r\n// Adiciona métodos personalizados\r\napi.getArray = async (url, config) => {\r\n  const response = await api.get(url, config);\r\n  return ensureArrayData(response.data);\r\n};\r\n\r\nexport default api;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}