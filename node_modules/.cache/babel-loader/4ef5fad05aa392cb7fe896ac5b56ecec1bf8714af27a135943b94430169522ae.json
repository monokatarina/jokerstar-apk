{"ast":null,"code":"import axios from'axios';const api=axios.create({baseURL:'https://api.jokesteronline.org/api',timeout:10000});// Interceptor de requisição\napi.interceptors.request.use(config=>{const token=localStorage.getItem('token');if(token){config.headers.Authorization=`Bearer ${token}`;}return config;},error=>{return Promise.reject(error);});// Interceptor de resposta\napi.interceptors.response.use(response=>{// Garante que a resposta tenha uma estrutura consistente\nif(response.data===undefined){return{...response,data:null};}return response;},async error=>{var _error$response,_error$response2,_error$response2$data,_error$response3,_error$response4;// Tratamento de erros 401 (Não autorizado)\nif(((_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.status)===401){localStorage.removeItem('token');localStorage.removeItem('user');// Evita redirecionamento duplo\nif(!window.location.pathname.includes('/login')){window.location.href='/login';}}// Padroniza a estrutura de erro\nconst apiError={message:((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:_error$response2$data.message)||'Erro na requisição',status:((_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.status)||500,data:((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.data)||null};return Promise.reject(apiError);});// Função auxiliar para garantir que os dados sejam sempre um array\nconst ensureArrayData=data=>{if(Array.isArray(data))return data;if(data&&Array.isArray(data.data))return data.data;if(data&&data.items&&Array.isArray(data.items))return data.items;return[];};// Adiciona métodos personalizados\napi.getArray=async(url,config)=>{const response=await api.get(url,config);return ensureArrayData(response.data);};export default api;","map":{"version":3,"names":["axios","api","create","baseURL","timeout","interceptors","request","use","config","token","localStorage","getItem","headers","Authorization","error","Promise","reject","response","data","undefined","_error$response","_error$response2","_error$response2$data","_error$response3","_error$response4","status","removeItem","window","location","pathname","includes","href","apiError","message","ensureArrayData","Array","isArray","items","getArray","url","get"],"sources":["C:/Users/drrod/OneDrive/Área de Trabalho/client2/src/services/api.js"],"sourcesContent":["import axios from 'axios';\n\nconst api = axios.create({\n  baseURL: 'https://api.jokesteronline.org/api',\n  timeout: 10000\n});\n\n// Interceptor de requisição\napi.interceptors.request.use(config => {\n  const token = localStorage.getItem('token');\n  if (token) {\n    config.headers.Authorization = `Bearer ${token}`;\n  }\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Interceptor de resposta\napi.interceptors.response.use(\n  response => {\n    // Garante que a resposta tenha uma estrutura consistente\n    if (response.data === undefined) {\n      return { ...response, data: null };\n    }\n    return response;\n  },\n  async error => {\n    // Tratamento de erros 401 (Não autorizado)\n    if (error.response?.status === 401) {\n      localStorage.removeItem('token');\n      localStorage.removeItem('user');\n      \n      // Evita redirecionamento duplo\n      if (!window.location.pathname.includes('/login')) {\n        window.location.href = '/login';\n      }\n    }\n\n    // Padroniza a estrutura de erro\n    const apiError = {\n      message: error.response?.data?.message || 'Erro na requisição',\n      status: error.response?.status || 500,\n      data: error.response?.data || null,\n    };\n\n    return Promise.reject(apiError);\n  }\n);\n\n// Função auxiliar para garantir que os dados sejam sempre um array\nconst ensureArrayData = (data) => {\n  if (Array.isArray(data)) return data;\n  if (data && Array.isArray(data.data)) return data.data;\n  if (data && data.items && Array.isArray(data.items)) return data.items;\n  return [];\n};\n\n// Adiciona métodos personalizados\napi.getArray = async (url, config) => {\n  const response = await api.get(url, config);\n  return ensureArrayData(response.data);\n};\n\nexport default api;\n"],"mappings":"AAAA,MAAO,CAAAA,KAAK,KAAM,OAAO,CAEzB,KAAM,CAAAC,GAAG,CAAGD,KAAK,CAACE,MAAM,CAAC,CACvBC,OAAO,CAAE,oCAAoC,CAC7CC,OAAO,CAAE,KACX,CAAC,CAAC,CAEF;AACAH,GAAG,CAACI,YAAY,CAACC,OAAO,CAACC,GAAG,CAACC,MAAM,EAAI,CACrC,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC,CAC3C,GAAIF,KAAK,CAAE,CACTD,MAAM,CAACI,OAAO,CAACC,aAAa,CAAG,UAAUJ,KAAK,EAAE,CAClD,CACA,MAAO,CAAAD,MAAM,CACf,CAAC,CAAEM,KAAK,EAAI,CACV,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CAAC,CAAC,CAEF;AACAb,GAAG,CAACI,YAAY,CAACY,QAAQ,CAACV,GAAG,CAC3BU,QAAQ,EAAI,CACV;AACA,GAAIA,QAAQ,CAACC,IAAI,GAAKC,SAAS,CAAE,CAC/B,MAAO,CAAE,GAAGF,QAAQ,CAAEC,IAAI,CAAE,IAAK,CAAC,CACpC,CACA,MAAO,CAAAD,QAAQ,CACjB,CAAC,CACD,KAAM,CAAAH,KAAK,EAAI,KAAAM,eAAA,CAAAC,gBAAA,CAAAC,qBAAA,CAAAC,gBAAA,CAAAC,gBAAA,CACb;AACA,GAAI,EAAAJ,eAAA,CAAAN,KAAK,CAACG,QAAQ,UAAAG,eAAA,iBAAdA,eAAA,CAAgBK,MAAM,IAAK,GAAG,CAAE,CAClCf,YAAY,CAACgB,UAAU,CAAC,OAAO,CAAC,CAChChB,YAAY,CAACgB,UAAU,CAAC,MAAM,CAAC,CAE/B;AACA,GAAI,CAACC,MAAM,CAACC,QAAQ,CAACC,QAAQ,CAACC,QAAQ,CAAC,QAAQ,CAAC,CAAE,CAChDH,MAAM,CAACC,QAAQ,CAACG,IAAI,CAAG,QAAQ,CACjC,CACF,CAEA;AACA,KAAM,CAAAC,QAAQ,CAAG,CACfC,OAAO,CAAE,EAAAZ,gBAAA,CAAAP,KAAK,CAACG,QAAQ,UAAAI,gBAAA,kBAAAC,qBAAA,CAAdD,gBAAA,CAAgBH,IAAI,UAAAI,qBAAA,iBAApBA,qBAAA,CAAsBW,OAAO,GAAI,oBAAoB,CAC9DR,MAAM,CAAE,EAAAF,gBAAA,CAAAT,KAAK,CAACG,QAAQ,UAAAM,gBAAA,iBAAdA,gBAAA,CAAgBE,MAAM,GAAI,GAAG,CACrCP,IAAI,CAAE,EAAAM,gBAAA,CAAAV,KAAK,CAACG,QAAQ,UAAAO,gBAAA,iBAAdA,gBAAA,CAAgBN,IAAI,GAAI,IAChC,CAAC,CAED,MAAO,CAAAH,OAAO,CAACC,MAAM,CAACgB,QAAQ,CAAC,CACjC,CACF,CAAC,CAED;AACA,KAAM,CAAAE,eAAe,CAAIhB,IAAI,EAAK,CAChC,GAAIiB,KAAK,CAACC,OAAO,CAAClB,IAAI,CAAC,CAAE,MAAO,CAAAA,IAAI,CACpC,GAAIA,IAAI,EAAIiB,KAAK,CAACC,OAAO,CAAClB,IAAI,CAACA,IAAI,CAAC,CAAE,MAAO,CAAAA,IAAI,CAACA,IAAI,CACtD,GAAIA,IAAI,EAAIA,IAAI,CAACmB,KAAK,EAAIF,KAAK,CAACC,OAAO,CAAClB,IAAI,CAACmB,KAAK,CAAC,CAAE,MAAO,CAAAnB,IAAI,CAACmB,KAAK,CACtE,MAAO,EAAE,CACX,CAAC,CAED;AACApC,GAAG,CAACqC,QAAQ,CAAG,MAAOC,GAAG,CAAE/B,MAAM,GAAK,CACpC,KAAM,CAAAS,QAAQ,CAAG,KAAM,CAAAhB,GAAG,CAACuC,GAAG,CAACD,GAAG,CAAE/B,MAAM,CAAC,CAC3C,MAAO,CAAA0B,eAAe,CAACjB,QAAQ,CAACC,IAAI,CAAC,CACvC,CAAC,CAED,cAAe,CAAAjB,GAAG","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}