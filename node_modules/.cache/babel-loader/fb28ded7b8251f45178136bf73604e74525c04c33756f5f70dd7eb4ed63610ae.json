{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import styled,{keyframes}from'styled-components';import{FiMessageSquare,FiShare2,FiRepeat,FiTrash2,FiX,FiCheck,FiChevronDown}from'react-icons/fi';import{FaSmile,FaAngry,FaCheck,FaEllipsisH}from'react-icons/fa';import api from'../services/api';import{useAuth}from'../contexts/AuthContext';import CommentSection from'./CommentSection';import{useNavigate}from'react-router-dom';import{renderMentions}from'../utils/renderMentions';import{extractMentions}from'../utils/mentionUtils';// Animations\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const popIn=keyframes`\n  0% { transform: scale(0.5); opacity: 0; }\n  70% { transform: scale(1.2); opacity: 0.7; }\n  100% { transform: scale(1); opacity: 1; }\n`;const pulse=keyframes`\n  0% { transform: scale(1); }\n  50% { transform: scale(1.1); }\n  100% { transform: scale(1); }\n`;const floating=keyframes`\n  0% { transform: translateY(0px); }\n  50% { transform: translateY(-10px); }\n  100% { transform: translateY(0px); }\n`;const gradientBackground=keyframes`\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n`;const fadeIn=keyframes`\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n`;const slideUp=keyframes`\n  from { transform: translateY(100%); opacity: 0; }\n  to { transform: translateY(0); opacity: 1; }\n`;const slideDown=keyframes`\n  from { transform: translateY(0); opacity: 1; }\n  to { transform: translateY(100%); opacity: 0; }\n`;// Estilos\nconst CommentOverlay=styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  opacity: ${props=>props.$visible?1:0};\n  transition: opacity 0.3s ease;\n  pointer-events: ${props=>props.$visible?'auto':'none'};\n`;const MobileCommentSection=styled.div`\n  @media (max-width: 768px) {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 100vh;\n    max-height: 100vh;\n    background: var(--card-bg);\n    border-radius: 16px 16px 0 0;\n    box-shadow: 0 -4px 20px rgba(0,0,0,0.2);\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    transform: translateY(${props=>props.$isOpen?'0':'100%'});\n    transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n    touch-action: pan-y;\n\n    &::before {\n      content: '';\n      position: absolute;\n      top: 8px;\n      left: 50%;\n      transform: translateX(-50%);\n      width: 40px;\n      height: 4px;\n      background: var(--text-light);\n      border-radius: 2px;\n      opacity: 0.5;\n    }\n  }\n`;// Substitua o ImprovedMobileCommentSection por este:\nconst ImprovedMobileCommentSection=styled(MobileCommentSection)`\n  transition: transform 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);\n  transform: translateY(calc(${props=>props.$offset}px + ${props=>props.$isOpen?'0%':'100%'}));\n  opacity: ${props=>1-props.$offset/200};\n  border-radius: 16px 16px 0 0;\n  background: var(--card-bg);\n  height: 80vh;\n  max-height: 80vh;\n  pointer-events: auto;\n  touch-action: none; /* Importante para controle total do toque */\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 12px;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 6px;\n    background: var(--text-light);\n    border-radius: 3px;\n    opacity: ${props=>1-props.$offset/100};\n  }\n`;const DragHandle=styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 48px; /* √Årea maior para arraste */\n  z-index: 1;\n  cursor: grab;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  \n  &:active {\n    cursor: grabbing;\n  }\n`;const CommentSectionContainer=styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n  position: relative;\n  padding-bottom: 0;\n`;const CommentFormContainer=styled.div`\n  position: sticky;\n  bottom: 0;\n  padding: 12px;\n  background: var(--card-bg);\n  border-top: 1px solid var(--border-light);\n`;const CloseCommentsButton=styled.button`\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  background: none;\n  border: none;\n  color: var(--text-light);\n  padding: 8px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(0,0,0,0.1);\n  }\n`;const CommentToggleButton=styled.button`\n  position: relative;\n  background: none;\n  border: none;\n  padding: 8px;\n  color: ${props=>props.$active?'var(--primary)':'var(--text-light)'};\n  display: flex;\n  align-items: center;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: -4px;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 30px;\n    height: 2px;\n    background: var(--primary);\n    opacity: ${_ref=>{let{$active}=_ref;return $active?1:0;}};\n    transition: opacity 0.3s ease;\n  }\n`;const OptionsButton=styled.button`\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  background: rgba(0, 0, 0, 0.7);\n  border: none;\n  border-radius: 50%;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.9);\n    transform: scale(1.1);\n  }\n`;const ConfirmationDialog=styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  animation: ${fadeIn} 0.3s ease-out;\n`;const DialogContent=styled.div`\n  background: var(--card-bg);\n  padding: 2rem;\n  border-radius: var(--radius-md);\n  width: 90%;\n  max-width: 400px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n  animation: ${slideUp} 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n`;const DialogTitle=styled.h3`\n  margin: 0 0 1.5rem;\n  color: var(--text);\n  font-size: 1.2rem;\n  text-align: center;\n`;const DialogButtons=styled.div`\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  margin-top: 2rem;\n`;const DialogButton=styled.button`\n  padding: 0.75rem 1.5rem;\n  border-radius: var(--radius-sm);\n  border: none;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: var(--transition);\n  \n  &:first-child {\n    background: var(--danger);\n    color: white;\n    \n    &:hover {\n      background: var(--danger-hover);\n      transform: translateY(-2px);\n    }\n  }\n  \n  &:last-child {\n    background: var(--background);\n    color: var(--text);\n    border: 1px solid var(--border);\n    \n    &:hover {\n      background: var(--background-light);\n      transform: translateY(-2px);\n    }\n  }\n`;const SuccessMessage=styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 1rem 2rem;\n  border-radius: 2rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  animation: ${popIn} 0.5s forwards;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n  \n  svg {\n    color: var(--success);\n  }\n`;const OptionsMenu=styled.div`\n  position: absolute;\n  top: 40px;\n  right: 5px;\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n  z-index: 10;\n  min-width: 150px;\n`;const OptionItem=styled.button`\n  width: 100%;\n  padding: 10px 15px;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  background: none;\n  border: none;\n  color: #333;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f5f5f5;\n    color: #ff4500;\n  }\n`;const Card=styled.div`\n  background: var(--card-bg);\n  border-radius: var(--radius-md);\n  margin-bottom: 1.5rem;\n  box-shadow: var(--shadow);\n  overflow: hidden;\n  transition: var(--transition);\n  position: relative;\n  border: 1px solid var(--border);\n  transform: ${_ref2=>{let{$deleting}=_ref2;return $deleting?'scale(0.98)':'scale(1)';}};\n  opacity: ${_ref3=>{let{$deleting}=_ref3;return $deleting?0.8:1;}};\n  \n  &:hover {\n    box-shadow: var(--shadow-hover);\n  }\n`;const RepostBadge=styled.div`\n  position: absolute;\n  top: 0.625rem;\n  left: 0.625rem;\n  background: linear-gradient(45deg, var(--primary), var(--primary-hover));\n  color: var(--card-bg);\n  padding: 0.375rem 0.75rem;\n  border-radius: 1.25rem;\n  font-size: 0.8rem;\n  display: flex;\n  align-items: center;\n  z-index: 1;\n  box-shadow: 0 2px 8px rgba(var(--primary-rgb), 0.3);\n  text-shadow: 0 1px 2px rgba(0,0,0,0.2);\n  animation: ${floating} 3s ease-in-out infinite;\n  \n  svg {\n    margin-right: 0.25rem;\n  }\n`;const Header=styled.div`\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n  background: var(--background);\n  position: relative;\n  border-bottom: 1px solid var(--border-light);\n`;const Avatar=styled.img`\n  width: 3.125rem;\n  height: 3.125rem;\n  border-radius: 50%;\n  margin-right: 0.75rem;\n  object-fit: cover;\n  border: 3px solid var(--primary);\n  transition: var(--transition);\n  position: relative;\n  overflow: hidden;\n  cursor: pointer;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.8), transparent);\n    transform: rotate(45deg);\n    animation: ${gradientBackground} 3s infinite linear;\n  }\n  \n  &:hover {\n    transform: rotate(15deg) scale(1.1);\n    border-color: var(--primary-hover);\n  }\n`;const Username=styled.span`\n  font-weight: 700;\n  font-size: 1rem;\n  color: var(--text);\n  transition: var(--transition);\n  cursor: pointer;\n  position: relative;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    width: 0;\n    height: 2px;\n    background: var(--primary);\n    transition: width 0.3s;\n  }\n  \n  &:hover {\n    color: var(--primary);\n    \n    &::after {\n      width: 100%;\n    }\n  }\n`;const ResponsiveImage=styled.img`\n  max-width: 100%;\n  max-height: 100%;\n  width: auto;\n  height: auto;\n  object-fit: contain;\n  transition: var(--transition);\n  border-radius: var(--radius-md);\n  \n  @media (max-width: 768px) {\n    object-fit: cover; /* Preenche o espa√ßo quadrado sem distorcer */\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n  \n  &:hover {\n    transform: scale(1.03);\n    filter: saturate(1.2) brightness(1.05);\n  }\n`;const ResponsiveVideo=styled.video`\n  max-width: 100%;\n  max-height: 100%;\n  width: auto;\n  height: auto;\n  object-fit: contain;\n  border-radius: var(--radius-md);\n  z-index: 1;\n  transition: var(--transition);\n  \n  @media (max-width: 768px) {\n    object-fit: cover; /* Preenche o espa√ßo quadrado sem distorcer */\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n  \n  &:hover {\n    transform: scale(1.03);\n    filter: saturate(1.2) brightness(1.05);\n  }\n`;const MediaContainer=styled.div`\n  width: 100%;\n  max-height: 43.75rem;\n  min-height: 18.75rem;\n  background: var(--background);\n  color: var(--text);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  overflow: hidden;\n\n  @media (max-width: 768px) {\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n`;const VideoContainer=styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  overflow: hidden;\n  border-radius: var(--radius-md);\n`;const PlayButton=styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 5rem;\n  height: 5rem;\n  background: rgba(var(--primary-rgb), 0.8);\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 2;\n  transition: var(--transition);\n  backdrop-filter: blur(2px);\n  box-shadow: var(--shadow);\n  \n  &::before {\n    content: '';\n    position: absolute;\n    width: 0;\n    height: 0;\n    border-top: 0.9375rem solid transparent;\n    border-bottom: 0.9375rem solid transparent;\n    border-left: 1.5625rem solid var(--card-bg);\n    margin-left: 0.3125rem;\n  }\n  \n  &:hover {\n    background: rgba(var(--primary-rgb), 0.9);\n    transform: translate(-50%, -50%) scale(1.1);\n  }\n`;const VideoControls=styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);\n  padding: 0.625rem;\n  display: flex;\n  align-items: center;\n  z-index: 3;\n  opacity: 0;\n  transition: var(--transition);\n  \n  &:hover {\n    opacity: 1;\n    animation: ${fadeIn} 0.3s forwards;\n  }\n`;const ControlButton=styled.button`\n  background: none;\n  border: none;\n  color: var(--card-bg);\n  font-size: 1.2rem;\n  margin: 0 0.3125rem;\n  cursor: pointer;\n  transition: var(--transition);\n  \n  &:hover {\n    color: var(--primary);\n    transform: scale(1.2);\n  }\n`;const ProgressBar=styled.div`\n  flex-grow: 1;\n  height: 0.25rem;\n  background: rgba(255,255,255,0.3);\n  border-radius: 0.125rem;\n  margin: 0 0.625rem;\n  position: relative;\n  overflow: hidden;\n  cursor: pointer;\n`;const Progress=styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: ${props=>props.$progress||'0%'};\n  background: var(--primary);\n  border-radius: 0.125rem;\n`;const TimeDisplay=styled.span`\n  color: var(--card-bg);\n  font-size: 0.8rem;\n  min-width: 5rem;\n  text-align: center;\n`;const Caption=styled.p`\n  padding: 1rem;\n  margin: 0;\n  font-size: 0.95rem;\n  line-height: 1.5;\n  color: var(--text);\n  background: var(--card-bg);\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 0.25rem;\n    height: 100%;\n    background: linear-gradient(to bottom, var(--primary), var(--primary-hover));\n  }\n`;const Tags=styled.div`\n  padding: 0 1rem 0.75rem;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  background: var(--card-bg);\n`;const Tag=styled.span`\n  color: var(--card-bg);\n  font-size: 0.85rem;\n  background: linear-gradient(45deg, var(--primary), var(--primary-hover));\n  padding: 0.375rem 0.75rem;\n  border-radius: 1.25rem;\n  transition: var(--transition);\n  text-shadow: 0 1px 2px rgba(0,0,0,0.2);\n  cursor: pointer;\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.3);\n  }\n`;const Actions=styled.div`\n  display: flex;\n  padding: 0.75rem 1rem;\n  border-top: 1px solid var(--border-light);\n  background: var(--card-bg);\n  justify-content: space-between;\n`;const ActionGroup=styled.div`\n  display: flex;\n  gap: 0.5rem;\n`;const ActionButton=styled.button`\n  background: none;\n  border: none;\n  display: flex;\n  align-items: center;\n  color: ${props=>props.$active?props.$color||'var(--primary)':'var(--text-light)'};\n  cursor: pointer;\n  font-size: 0.9rem;\n  padding: 0.5rem 1rem;\n  border-radius: var(--radius-sm);\n  transition: var(--transition);\n  position: relative;\n  overflow: hidden;\n  \n  svg {\n    margin-right: 0.375rem;\n    font-size: 1.2rem;\n    transition: var(--transition);\n  }\n\n  &:hover {\n    background: rgba(var(--primary-rgb), 0.05);\n    color: ${props=>props.$color||'var(--primary)'};\n    transform: translateY(-2px);\n    \n    svg {\n      transform: scale(1.2);\n    }\n  }\n  \n  &::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    background: rgba(255,255,255,0.2);\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    transition: var(--transition);\n  }\n  \n  &:hover::after {\n    width: 120%;\n    height: 120%;\n  }\n  \n  &:active {\n    transform: scale(0.95) translateY(-2px);\n  }\n`;const RepostButton=styled(ActionButton)`\n  color: ${props=>props.$active?'var(--success)':'var(--text-light)'};\n  \n  &:hover {\n    color: var(--success);\n  }\n`;const ReactionAnimation=styled.div`\n  position: absolute;\n  animation: ${popIn} 0.5s forwards, ${pulse} 0.5s 0.5s forwards;\n  font-size: 2.5rem;\n  opacity: 0;\n  pointer-events: none;\n  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));\n  text-shadow: 0 2px 4px rgba(0,0,0,0.3);\n  z-index: 10;\n`;const MemeCard=_ref4=>{var _meme$likes,_meme$author2,_meme$repostedBy,_meme$author3,_meme$author3$profile,_meme$author4,_meme$author5,_videoRef$current,_meme$tags,_meme$author6,_meme$author7;let{meme,isRepost=false,onDelete,onCommentCountChange,isFullScreen=false}=_ref4;const navigate=useNavigate();const{user}=useAuth();const[isLiked,setIsLiked]=useState(false);const[likeCount,setLikeCount]=useState(((_meme$likes=meme.likes)===null||_meme$likes===void 0?void 0:_meme$likes.length)||0);const[showComments,setShowComments]=useState(false);const commentCount=meme.commentCount||0;const[reaction,setReaction]=useState(null);const[isReposted,setIsReposted]=useState(false);const[repostCount,setRepostCount]=useState(meme.repostCount||0);const[isCheckingRepost,setIsCheckingRepost]=useState(true);const[showOptions,setShowOptions]=useState(false);const[isDeleting,setIsDeleting]=useState(false);const[showSuccess,setShowSuccess]=useState(false);const[showConfirmDialog,setShowConfirmDialog]=useState(false);const[deletionProgress,setDeletionProgress]=useState(0);const[mentionMap,setMentionMap]=useState({});const[isPlaying,setIsPlaying]=useState(false);const[progress,setProgress]=useState(0);const[duration,setDuration]=useState(0);const[currentTime,setCurrentTime]=useState(0);const videoRef=useRef(null);const commentSectionRef=useRef(null);const touchStartY=useRef(null);const[dragOffset,setDragOffset]=useState(0);const[isDragging,setIsDragging]=useState(false);const[dragStart,setDragStart]=useState(null);const[currentDrag,setCurrentDrag]=useState(0);const[shouldClose,setShouldClose]=useState(false);useEffect(()=>{var _meme$likes2;const processMentions=async()=>{if(meme.caption){try{const result=await extractMentions(meme.caption);setMentionMap(result.mentionMap||{});}catch(error){console.error('Error processing mentions:',error);setMentionMap({});}}};processMentions();if(user&&meme.likes){setIsLiked(meme.likes.some(like=>like.toString()===user._id));}setLikeCount(((_meme$likes2=meme.likes)===null||_meme$likes2===void 0?void 0:_meme$likes2.length)||0);setRepostCount(meme.repostCount||0);if(user){checkIfReposted();}else{setIsCheckingRepost(false);}},[meme,user]);const handleDelete=async()=>{setShowConfirmDialog(false);setIsDeleting(true);try{var _response$data;const interval=setInterval(()=>{setDeletionProgress(prev=>{if(prev>=90){clearInterval(interval);return prev;}return prev+10;});},100);const token=localStorage.getItem('token');const response=await api.delete(`/memes/${meme._id}`,{headers:{Authorization:`Bearer ${token}`,'Content-Type':'application/json'}});clearInterval(interval);setDeletionProgress(100);if(!((_response$data=response.data)!==null&&_response$data!==void 0&&_response$data.success)){var _response$data2;throw new Error(((_response$data2=response.data)===null||_response$data2===void 0?void 0:_response$data2.message)||'Falha ao deletar');}setShowSuccess(true);setTimeout(()=>{if(onDelete)onDelete(meme._id);setShowSuccess(false);},1500);}catch(err){var _err$response;console.error('Erro ao deletar meme:',err);if(((_err$response=err.response)===null||_err$response===void 0?void 0:_err$response.status)===410){if(onDelete)onDelete(meme._id);alert('Este meme j√° foi deletado anteriormente');}else{var _err$response2,_err$response2$data;alert(((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.message)||'Erro ao deletar meme');}}finally{setIsDeleting(false);setDeletionProgress(0);}};const openDeleteConfirmation=()=>{setShowOptions(false);setShowConfirmDialog(true);};const togglePlay=()=>{if(videoRef.current){if(isPlaying){videoRef.current.pause();}else{videoRef.current.play();}setIsPlaying(!isPlaying);}};const handleTimeUpdate=()=>{if(videoRef.current){const currentProgress=videoRef.current.currentTime/videoRef.current.duration*100;setProgress(currentProgress);setCurrentTime(videoRef.current.currentTime);}};const handleLoadedMetadata=()=>{if(videoRef.current){setDuration(videoRef.current.duration);}};const handleSeek=e=>{if(videoRef.current){const rect=e.target.getBoundingClientRect();const pos=(e.clientX-rect.left)/rect.width;videoRef.current.currentTime=pos*videoRef.current.duration;}};const formatTime=time=>{const minutes=Math.floor(time/60);const seconds=Math.floor(time%60);return`${minutes}:${seconds<10?'0':''}${seconds}`;};const checkIfReposted=async()=>{try{if(meme.originalMeme&&meme.author._id===user._id){setIsReposted(true);}else{var _meme$reposts;setIsReposted((_meme$reposts=meme.reposts)===null||_meme$reposts===void 0?void 0:_meme$reposts.some(repost=>repost.toString()===user._id));}}catch(error){console.error('Erro ao verificar repost:',error);}finally{setIsCheckingRepost(false);}};const handleLike=async()=>{if(!user)return;try{const response=await api.post(`/memes/${meme._id}/like`);setIsLiked(response.data.isLiked);setLikeCount(response.data.likeCount);setReaction(response.data.isLiked?'like':'dislike');setTimeout(()=>setReaction(null),1500);}catch(error){console.error('Erro ao curtir:',error);}};const handleDislike=async()=>{if(!user||!isLiked)return;try{const response=await api.post(`/memes/${meme._id}/like`);setIsLiked(false);setLikeCount(response.data.likeCount);setReaction('dislike');setTimeout(()=>setReaction(null),1500);}catch(error){console.error('Erro ao remover curtida:',error);}};const handleRepost=async()=>{var _meme$author;if(!user)return;if(((_meme$author=meme.author)===null||_meme$author===void 0?void 0:_meme$author._id)===user._id){setReaction('self-repost');setTimeout(()=>setReaction(null),1500);return;}if(isReposted||isRepost)return;try{const response=await api.post(`/memes/${meme._id}/repost`);setIsReposted(true);setRepostCount(response.data.repostCount);setReaction('repost');setTimeout(()=>setReaction(null),1500);}catch(error){console.error('Erro ao repostar:',error);if(error.response&&error.response.status===409){setIsReposted(true);}}};const handleCommentSubmit=async formData=>{try{const response=await api.post(`/memes/${meme._id}/comments`,formData,{headers:{'Content-Type':'multipart/form-data'}});const updatedMeme=await api.get(`/memes/${meme._id}`);const commentCount=meme.commentCount||0;return response.data;}catch(error){var _error$response,_error$response2,_error$response3,_error$response3$data;console.error('Erro detalhado:',{message:error.message,response:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data,status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,config:error.config});throw new Error(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.message)||error.message||'Erro ao enviar coment√°rio');}};const buildUrl=url=>{if(!url){console.warn('URL is empty or undefined');return'https://i.pravatar.cc/150?img=3';}if(url.startsWith('http://')){url='https://'+url.substring(7);}if(url.startsWith('https://')||url.startsWith('blob:')){return url;}const normalizedPath=url.startsWith('/')?url:`/${url}`;const apiUrl=process.env.REACT_APP_API_URL||'https://api.jokesteronline.org';const fullUrl=`${apiUrl}${normalizedPath}`;return fullUrl;};const toggleComments=()=>{setShowComments(!showComments);};const handleTouchStart=e=>{// Verificar se o toque come√ßou na √°rea de arraste superior\nconst touchY=e.touches[0].clientY;const isHandleTouch=touchY<100;// √Årea superior de 100px\nif(isHandleTouch&&showComments){setDragStart(touchY);setCurrentDrag(0);setShouldClose(false);}};const handleTouchMove=e=>{if(dragStart===null)return;const touchY=e.touches[0].clientY;const deltaY=touchY-dragStart;// Limitar o arraste para baixo\nif(deltaY>0){setCurrentDrag(Math.min(deltaY,300));setShouldClose(deltaY>100);// Bloquear a rolagem enquanto arrasta\nif(commentSectionRef.current){commentSectionRef.current.style.overflow='hidden';}}};const handleTouchEnd=()=>{if(dragStart===null)return;if(shouldClose){setShowComments(false);}// Resetar estados\nsetDragStart(null);setCurrentDrag(0);setShouldClose(false);// Restaurar a rolagem\nif(commentSectionRef.current){commentSectionRef.current.style.overflow='auto';}};useEffect(()=>{const element=commentSectionRef.current;if(!element)return;element.addEventListener('touchstart',handleTouchStart,{passive:false});element.addEventListener('touchmove',handleTouchMove,{passive:false});element.addEventListener('touchend',handleTouchEnd,{passive:false});return()=>{element.removeEventListener('touchstart',handleTouchStart);element.removeEventListener('touchmove',handleTouchMove);element.removeEventListener('touchend',handleTouchEnd);};},[showComments,dragStart,shouldClose]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{$deleting:isDeleting,style:isFullScreen?{width:'100%',height:'100%',marginBottom:0,borderRadius:0,border:'none',boxShadow:'none'}:{},children:[isDeleting&&/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:0,left:0,right:0,bottom:0,background:'rgba(0,0,0,0.5)',zIndex:5,display:'flex',justifyContent:'center',alignItems:'center'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:'80%',background:'rgba(255,255,255,0.2)',borderRadius:'10px',overflow:'hidden'},children:/*#__PURE__*/_jsx(\"div\",{style:{width:`${deletionProgress}%`,height:'6px',background:'var(--primary)',transition:'width 0.3s ease'}})})}),showSuccess&&/*#__PURE__*/_jsxs(SuccessMessage,{children:[/*#__PURE__*/_jsx(FaCheck,{size:18}),/*#__PURE__*/_jsx(\"span\",{children:\"Meme deletado com sucesso!\"})]}),(user===null||user===void 0?void 0:user._id)===((_meme$author2=meme.author)===null||_meme$author2===void 0?void 0:_meme$author2._id)&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'relative'},children:[/*#__PURE__*/_jsx(OptionsButton,{onClick:e=>{e.stopPropagation();setShowOptions(!showOptions);},children:/*#__PURE__*/_jsx(FaEllipsisH,{size:14})}),showOptions&&/*#__PURE__*/_jsx(OptionsMenu,{onClick:e=>e.stopPropagation(),children:/*#__PURE__*/_jsxs(OptionItem,{onClick:openDeleteConfirmation,children:[/*#__PURE__*/_jsx(FiTrash2,{size:14}),/*#__PURE__*/_jsx(\"span\",{children:\"Deletar\"})]})})]}),isRepost&&/*#__PURE__*/_jsxs(RepostBadge,{children:[/*#__PURE__*/_jsx(FiRepeat,{}),\" Repostado por @\",((_meme$repostedBy=meme.repostedBy)===null||_meme$repostedBy===void 0?void 0:_meme$repostedBy.username)||'usu√°rio']}),reaction&&/*#__PURE__*/_jsx(ReactionAnimation,{style:{top:'50%',left:'50%',transform:'translate(-50%, -50%)',color:reaction==='like'?'var(--primary)':reaction==='dislike'?'#f00':reaction==='repost'?'#10b981':'var(--primary)'},children:reaction==='like'?/*#__PURE__*/_jsx(FaSmile,{}):reaction==='dislike'?/*#__PURE__*/_jsx(FaAngry,{}):reaction==='repost'?/*#__PURE__*/_jsx(FaCheck,{}):/*#__PURE__*/_jsx(\"span\",{style:{fontSize:'1rem'},children:\"Voc\\xEA \\xE9 o autor!\"})}),/*#__PURE__*/_jsxs(Header,{children:[/*#__PURE__*/_jsx(Avatar,{src:(_meme$author3=meme.author)!==null&&_meme$author3!==void 0&&(_meme$author3$profile=_meme$author3.profile)!==null&&_meme$author3$profile!==void 0&&_meme$author3$profile.avatar?buildUrl(meme.author.profile.avatar):'https://i.pravatar.cc/150?img=3',alt:(_meme$author4=meme.author)===null||_meme$author4===void 0?void 0:_meme$author4.username,onClick:()=>meme.author&&navigate(`/users/${meme.author._id}`),crossOrigin:\"anonymous\",onError:e=>{e.target.src='https://i.pravatar.cc/150?img=3';}}),/*#__PURE__*/_jsxs(Username,{onClick:()=>meme.author&&navigate(`/users/${meme.author._id}`),children:[\"@\",((_meme$author5=meme.author)===null||_meme$author5===void 0?void 0:_meme$author5.username)||'usu√°rio desconhecido']})]}),/*#__PURE__*/_jsx(MediaContainer,{children:meme.mediaType==='image'?/*#__PURE__*/_jsx(ResponsiveImage,{src:buildUrl(meme.mediaUrl),alt:meme.caption||'Meme image',style:{transform:showComments?'scale(0.98)':'scale(1)',filter:showComments?'brightness(0.95)':'none'},crossOrigin:\"anonymous\",onError:e=>{e.target.src='https://placehold.co/600x400?text=Imagem+n√£o+carregada';e.target.onerror=null;}}):/*#__PURE__*/_jsxs(VideoContainer,{onClick:togglePlay,children:[/*#__PURE__*/_jsx(ResponsiveVideo,{ref:videoRef,src:buildUrl(meme.mediaUrl),preload:\"metadata\",onTimeUpdate:handleTimeUpdate,onLoadedMetadata:handleLoadedMetadata,onEnded:()=>setIsPlaying(false),crossOrigin:\"anonymous\"}),!isPlaying&&/*#__PURE__*/_jsx(PlayButton,{onClick:e=>{e.stopPropagation();togglePlay();}}),/*#__PURE__*/_jsxs(VideoControls,{onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(ControlButton,{onClick:togglePlay,children:isPlaying?'‚ùö‚ùö':'‚ñ∂'}),/*#__PURE__*/_jsx(ProgressBar,{onClick:handleSeek,children:/*#__PURE__*/_jsx(Progress,{$progress:`${progress}%`})}),/*#__PURE__*/_jsxs(TimeDisplay,{children:[formatTime(currentTime),\" / \",formatTime(duration)]}),/*#__PURE__*/_jsx(ControlButton,{onClick:()=>{if(videoRef.current){videoRef.current.muted=!videoRef.current.muted;}},children:(_videoRef$current=videoRef.current)!==null&&_videoRef$current!==void 0&&_videoRef$current.muted?'üîá':'üîà'})]}),/*#__PURE__*/_jsx(\"div\",{style:{position:'absolute',top:0,left:0,right:0,bottom:0,background:`linear-gradient(45deg, \n                  rgba(255,255,255,0.1), \n                  rgba(255,69,0,0.05))`,pointerEvents:'none'}})]})}),meme.caption&&/*#__PURE__*/_jsx(Caption,{children:React.Children.toArray(renderMentions(meme.caption,mentionMap,navigate))}),((_meme$tags=meme.tags)===null||_meme$tags===void 0?void 0:_meme$tags.length)>0&&/*#__PURE__*/_jsx(Tags,{children:meme.tags.map(tag=>/*#__PURE__*/_jsxs(Tag,{onClick:()=>navigate(`/explore?tag=${tag}`),children:[\"#\",tag]},tag))}),/*#__PURE__*/_jsxs(Actions,{children:[/*#__PURE__*/_jsxs(ActionGroup,{children:[/*#__PURE__*/_jsxs(ActionButton,{onClick:handleLike,$active:isLiked,$color:\"var(--primary)\",children:[/*#__PURE__*/_jsx(FaSmile,{}),\" \",likeCount]}),/*#__PURE__*/_jsx(ActionButton,{onClick:handleDislike,$active:!isLiked&&likeCount>0,$color:\"var(--text)\",children:/*#__PURE__*/_jsx(FaAngry,{})}),/*#__PURE__*/_jsxs(ActionButton,{onClick:toggleComments,$active:showComments,$color:\"#f000\",children:[/*#__PURE__*/_jsx(FiMessageSquare,{}),\" \",commentCount]})]}),/*#__PURE__*/_jsxs(ActionGroup,{children:[/*#__PURE__*/_jsxs(RepostButton,{onClick:handleRepost,$active:isReposted,disabled:isReposted||isCheckingRepost||isRepost||((_meme$author6=meme.author)===null||_meme$author6===void 0?void 0:_meme$author6._id)===(user===null||user===void 0?void 0:user._id),title:((_meme$author7=meme.author)===null||_meme$author7===void 0?void 0:_meme$author7._id)===(user===null||user===void 0?void 0:user._id)?\"Voc√™ n√£o pode repostar seu pr√≥prio conte√∫do\":\"\",children:[isCheckingRepost?/*#__PURE__*/_jsx(FiRepeat,{}):isReposted?/*#__PURE__*/_jsx(FaCheck,{}):/*#__PURE__*/_jsx(FiRepeat,{}),\" \",repostCount]}),/*#__PURE__*/_jsx(ActionButton,{children:/*#__PURE__*/_jsx(FiShare2,{})})]})]})]}),showComments&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(CommentOverlay,{$visible:showComments,onClick:toggleComments}),/*#__PURE__*/_jsxs(ImprovedMobileCommentSection,{$isOpen:showComments,$offset:dragOffset,children:[/*#__PURE__*/_jsx(DragHandle,{className:\"drag-handle\",onTouchStart:handleTouchStart,onTouchMove:handleTouchMove,onTouchEnd:handleTouchEnd}),/*#__PURE__*/_jsxs(CommentSectionContainer,{style:{touchAction:isDragging?'none':'auto',pointerEvents:isDragging?'none':'auto'},ref:commentSectionRef,onScroll:()=>setIsDragging(false),onClick:e=>e.stopPropagation(),children:[/*#__PURE__*/_jsx(CloseCommentsButton,{onClick:toggleComments,children:/*#__PURE__*/_jsx(FiChevronDown,{size:24})}),/*#__PURE__*/_jsx(CommentSection,{memeId:meme._id,onCommentSubmit:handleCommentSubmit,onCommentCountChange:onCommentCountChange})]})]})]}),showConfirmDialog&&/*#__PURE__*/_jsx(ConfirmationDialog,{children:/*#__PURE__*/_jsxs(DialogContent,{children:[/*#__PURE__*/_jsx(DialogTitle,{children:\"Tem certeza que deseja deletar este meme?\"}),/*#__PURE__*/_jsx(\"p\",{style:{textAlign:'center',color:'var(--text-light)'},children:\"Esta a\\xE7\\xE3o \\xE9 irrevers\\xEDvel e remover\\xE1 o meme permanentemente.\"}),/*#__PURE__*/_jsxs(DialogButtons,{children:[/*#__PURE__*/_jsxs(DialogButton,{onClick:handleDelete,children:[/*#__PURE__*/_jsx(FiCheck,{size:16}),\"Confirmar\"]}),/*#__PURE__*/_jsxs(DialogButton,{onClick:()=>setShowConfirmDialog(false),children:[/*#__PURE__*/_jsx(FiX,{size:16}),\"Cancelar\"]})]})]})})]});};export default MemeCard;","map":{"version":3,"names":["React","useState","useEffect","useRef","styled","keyframes","FiMessageSquare","FiShare2","FiRepeat","FiTrash2","FiX","FiCheck","FiChevronDown","FaSmile","FaAngry","FaCheck","FaEllipsisH","api","useAuth","CommentSection","useNavigate","renderMentions","extractMentions","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","popIn","pulse","floating","gradientBackground","fadeIn","slideUp","slideDown","CommentOverlay","div","props","$visible","MobileCommentSection","$isOpen","ImprovedMobileCommentSection","$offset","DragHandle","CommentSectionContainer","CommentFormContainer","CloseCommentsButton","button","CommentToggleButton","$active","_ref","OptionsButton","ConfirmationDialog","DialogContent","DialogTitle","h3","DialogButtons","DialogButton","SuccessMessage","OptionsMenu","OptionItem","Card","_ref2","$deleting","_ref3","RepostBadge","Header","Avatar","img","Username","span","ResponsiveImage","ResponsiveVideo","video","MediaContainer","VideoContainer","PlayButton","VideoControls","ControlButton","ProgressBar","Progress","$progress","TimeDisplay","Caption","p","Tags","Tag","Actions","ActionGroup","ActionButton","$color","RepostButton","ReactionAnimation","MemeCard","_ref4","_meme$likes","_meme$author2","_meme$repostedBy","_meme$author3","_meme$author3$profile","_meme$author4","_meme$author5","_videoRef$current","_meme$tags","_meme$author6","_meme$author7","meme","isRepost","onDelete","onCommentCountChange","isFullScreen","navigate","user","isLiked","setIsLiked","likeCount","setLikeCount","likes","length","showComments","setShowComments","commentCount","reaction","setReaction","isReposted","setIsReposted","repostCount","setRepostCount","isCheckingRepost","setIsCheckingRepost","showOptions","setShowOptions","isDeleting","setIsDeleting","showSuccess","setShowSuccess","showConfirmDialog","setShowConfirmDialog","deletionProgress","setDeletionProgress","mentionMap","setMentionMap","isPlaying","setIsPlaying","progress","setProgress","duration","setDuration","currentTime","setCurrentTime","videoRef","commentSectionRef","touchStartY","dragOffset","setDragOffset","isDragging","setIsDragging","dragStart","setDragStart","currentDrag","setCurrentDrag","shouldClose","setShouldClose","_meme$likes2","processMentions","caption","result","error","console","some","like","toString","_id","checkIfReposted","handleDelete","_response$data","interval","setInterval","prev","clearInterval","token","localStorage","getItem","response","delete","headers","Authorization","data","success","_response$data2","Error","message","setTimeout","err","_err$response","status","alert","_err$response2","_err$response2$data","openDeleteConfirmation","togglePlay","current","pause","play","handleTimeUpdate","currentProgress","handleLoadedMetadata","handleSeek","e","rect","target","getBoundingClientRect","pos","clientX","left","width","formatTime","time","minutes","Math","floor","seconds","originalMeme","author","_meme$reposts","reposts","repost","handleLike","post","handleDislike","handleRepost","_meme$author","handleCommentSubmit","formData","updatedMeme","get","_error$response","_error$response2","_error$response3","_error$response3$data","config","buildUrl","url","warn","startsWith","substring","normalizedPath","apiUrl","process","env","REACT_APP_API_URL","fullUrl","toggleComments","handleTouchStart","touchY","touches","clientY","isHandleTouch","handleTouchMove","deltaY","min","style","overflow","handleTouchEnd","element","addEventListener","passive","removeEventListener","children","height","marginBottom","borderRadius","border","boxShadow","position","top","right","bottom","background","zIndex","display","justifyContent","alignItems","transition","size","onClick","stopPropagation","repostedBy","username","transform","color","fontSize","src","profile","avatar","alt","crossOrigin","onError","mediaType","mediaUrl","filter","onerror","ref","preload","onTimeUpdate","onLoadedMetadata","onEnded","muted","pointerEvents","Children","toArray","tags","map","tag","disabled","title","className","onTouchStart","onTouchMove","onTouchEnd","touchAction","onScroll","memeId","onCommentSubmit","textAlign"],"sources":["C:/Users/drrod/OneDrive/√Årea de Trabalho/jokersta_apk/src/components/MemeCard.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport styled, { keyframes } from 'styled-components';\nimport { FiMessageSquare, FiShare2, FiRepeat, FiTrash2, FiX, FiCheck, FiChevronDown } from 'react-icons/fi';\nimport { FaSmile, FaAngry, FaCheck, FaEllipsisH } from 'react-icons/fa';\nimport api from '../services/api';\nimport { useAuth } from '../contexts/AuthContext';\nimport CommentSection from './CommentSection';\nimport { useNavigate } from 'react-router-dom';\nimport { renderMentions } from '../utils/renderMentions';\nimport { extractMentions } from '../utils/mentionUtils';\n\n// Animations\nconst popIn = keyframes`\n  0% { transform: scale(0.5); opacity: 0; }\n  70% { transform: scale(1.2); opacity: 0.7; }\n  100% { transform: scale(1); opacity: 1; }\n`;\n\nconst pulse = keyframes`\n  0% { transform: scale(1); }\n  50% { transform: scale(1.1); }\n  100% { transform: scale(1); }\n`;\n\nconst floating = keyframes`\n  0% { transform: translateY(0px); }\n  50% { transform: translateY(-10px); }\n  100% { transform: translateY(0px); }\n`;\n\nconst gradientBackground = keyframes`\n  0% { background-position: 0% 50%; }\n  50% { background-position: 100% 50%; }\n  100% { background-position: 0% 50%; }\n`;\n\nconst fadeIn = keyframes`\n  from { opacity: 0; transform: translateY(10px); }\n  to { opacity: 1; transform: translateY(0); }\n`;\n\nconst slideUp = keyframes`\n  from { transform: translateY(100%); opacity: 0; }\n  to { transform: translateY(0); opacity: 1; }\n`;\n\nconst slideDown = keyframes`\n  from { transform: translateY(0); opacity: 1; }\n  to { transform: translateY(100%); opacity: 0; }\n`;\n\n// Estilos\n\nconst CommentOverlay = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.5);\n  opacity: ${props => props.$visible ? 1 : 0};\n  transition: opacity 0.3s ease;\n  pointer-events: ${props => props.$visible ? 'auto' : 'none'};\n`;\n\nconst MobileCommentSection = styled.div`\n  @media (max-width: 768px) {\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 100vh;\n    max-height: 100vh;\n    background: var(--card-bg);\n    border-radius: 16px 16px 0 0;\n    box-shadow: 0 -4px 20px rgba(0,0,0,0.2);\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    transform: translateY(${props => props.$isOpen ? '0' : '100%'});\n    transition: transform 0.3s cubic-bezier(0.25, 0.1, 0.25, 1);\n    touch-action: pan-y;\n\n    &::before {\n      content: '';\n      position: absolute;\n      top: 8px;\n      left: 50%;\n      transform: translateX(-50%);\n      width: 40px;\n      height: 4px;\n      background: var(--text-light);\n      border-radius: 2px;\n      opacity: 0.5;\n    }\n  }\n`;\n\n// Substitua o ImprovedMobileCommentSection por este:\nconst ImprovedMobileCommentSection = styled(MobileCommentSection)`\n  transition: transform 0.2s cubic-bezier(0.25, 0.1, 0.25, 1);\n  transform: translateY(calc(${props => props.$offset}px + ${props => props.$isOpen ? '0%' : '100%'}));\n  opacity: ${props => 1 - (props.$offset / 200)};\n  border-radius: 16px 16px 0 0;\n  background: var(--card-bg);\n  height: 80vh;\n  max-height: 80vh;\n  pointer-events: auto;\n  touch-action: none; /* Importante para controle total do toque */\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 12px;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 60px;\n    height: 6px;\n    background: var(--text-light);\n    border-radius: 3px;\n    opacity: ${props => 1 - (props.$offset / 100)};\n  }\n`;\n\nconst DragHandle = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  height: 48px; /* √Årea maior para arraste */\n  z-index: 1;\n  cursor: grab;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  \n  &:active {\n    cursor: grabbing;\n  }\n`;\n\nconst CommentSectionContainer = styled.div`\n  flex: 1;\n  overflow-y: auto;\n  padding: 16px;\n  position: relative;\n  padding-bottom: 0;\n`;\n\nconst CommentFormContainer = styled.div`\n  position: sticky;\n  bottom: 0;\n  padding: 12px;\n  background: var(--card-bg);\n  border-top: 1px solid var(--border-light);\n`;\n\nconst CloseCommentsButton = styled.button`\n  position: absolute;\n  top: 12px;\n  right: 12px;\n  background: none;\n  border: none;\n  color: var(--text-light);\n  padding: 8px;\n  border-radius: 50%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  cursor: pointer;\n  transition: all 0.2s;\n\n  &:hover {\n    background: rgba(0,0,0,0.1);\n  }\n`;\n\nconst CommentToggleButton = styled.button`\n  position: relative;\n  background: none;\n  border: none;\n  padding: 8px;\n  color: ${props => props.$active ? 'var(--primary)' : 'var(--text-light)'};\n  display: flex;\n  align-items: center;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: -4px;\n    left: 50%;\n    transform: translateX(-50%);\n    width: 30px;\n    height: 2px;\n    background: var(--primary);\n    opacity: ${({ $active }) => ($active ? 1 : 0)};\n    transition: opacity 0.3s ease;\n  }\n`;\n\nconst OptionsButton = styled.button`\n  position: absolute;\n  top: 5px;\n  right: 5px;\n  background: rgba(0, 0, 0, 0.7);\n  border: none;\n  border-radius: 50%;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  color: white;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: rgba(0, 0, 0, 0.9);\n    transform: scale(1.1);\n  }\n`;\n\nconst ConfirmationDialog = styled.div`\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  animation: ${fadeIn} 0.3s ease-out;\n`;\n\nconst DialogContent = styled.div`\n  background: var(--card-bg);\n  padding: 2rem;\n  border-radius: var(--radius-md);\n  width: 90%;\n  max-width: 400px;\n  box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);\n  animation: ${slideUp} 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);\n`;\n\nconst DialogTitle = styled.h3`\n  margin: 0 0 1.5rem;\n  color: var(--text);\n  font-size: 1.2rem;\n  text-align: center;\n`;\n\nconst DialogButtons = styled.div`\n  display: flex;\n  gap: 1rem;\n  justify-content: center;\n  margin-top: 2rem;\n`;\n\nconst DialogButton = styled.button`\n  padding: 0.75rem 1.5rem;\n  border-radius: var(--radius-sm);\n  border: none;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  transition: var(--transition);\n  \n  &:first-child {\n    background: var(--danger);\n    color: white;\n    \n    &:hover {\n      background: var(--danger-hover);\n      transform: translateY(-2px);\n    }\n  }\n  \n  &:last-child {\n    background: var(--background);\n    color: var(--text);\n    border: 1px solid var(--border);\n    \n    &:hover {\n      background: var(--background-light);\n      transform: translateY(-2px);\n    }\n  }\n`;\n\nconst SuccessMessage = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: rgba(0, 0, 0, 0.8);\n  color: white;\n  padding: 1rem 2rem;\n  border-radius: 2rem;\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  animation: ${popIn} 0.5s forwards;\n  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);\n  \n  svg {\n    color: var(--success);\n  }\n`;\n\nconst OptionsMenu = styled.div`\n  position: absolute;\n  top: 40px;\n  right: 5px;\n  background: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  overflow: hidden;\n  z-index: 10;\n  min-width: 150px;\n`;\n\nconst OptionItem = styled.button`\n  width: 100%;\n  padding: 10px 15px;\n  display: flex;\n  align-items: center;\n  gap: 10px;\n  background: none;\n  border: none;\n  color: #333;\n  cursor: pointer;\n  transition: all 0.2s ease;\n\n  &:hover {\n    background: #f5f5f5;\n    color: #ff4500;\n  }\n`;\n\nconst Card = styled.div`\n  background: var(--card-bg);\n  border-radius: var(--radius-md);\n  margin-bottom: 1.5rem;\n  box-shadow: var(--shadow);\n  overflow: hidden;\n  transition: var(--transition);\n  position: relative;\n  border: 1px solid var(--border);\n  transform: ${({ $deleting }) => $deleting ? 'scale(0.98)' : 'scale(1)'};\n  opacity: ${({ $deleting }) => $deleting ? 0.8 : 1};\n  \n  &:hover {\n    box-shadow: var(--shadow-hover);\n  }\n`;\n\nconst RepostBadge = styled.div`\n  position: absolute;\n  top: 0.625rem;\n  left: 0.625rem;\n  background: linear-gradient(45deg, var(--primary), var(--primary-hover));\n  color: var(--card-bg);\n  padding: 0.375rem 0.75rem;\n  border-radius: 1.25rem;\n  font-size: 0.8rem;\n  display: flex;\n  align-items: center;\n  z-index: 1;\n  box-shadow: 0 2px 8px rgba(var(--primary-rgb), 0.3);\n  text-shadow: 0 1px 2px rgba(0,0,0,0.2);\n  animation: ${floating} 3s ease-in-out infinite;\n  \n  svg {\n    margin-right: 0.25rem;\n  }\n`;\n\nconst Header = styled.div`\n  display: flex;\n  align-items: center;\n  padding: 1rem;\n  background: var(--background);\n  position: relative;\n  border-bottom: 1px solid var(--border-light);\n`;\n\nconst Avatar = styled.img`\n  width: 3.125rem;\n  height: 3.125rem;\n  border-radius: 50%;\n  margin-right: 0.75rem;\n  object-fit: cover;\n  border: 3px solid var(--primary);\n  transition: var(--transition);\n  position: relative;\n  overflow: hidden;\n  cursor: pointer;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: -50%;\n    left: -50%;\n    width: 200%;\n    height: 200%;\n    background: linear-gradient(45deg, transparent, rgba(255,255,255,0.8), transparent);\n    transform: rotate(45deg);\n    animation: ${gradientBackground} 3s infinite linear;\n  }\n  \n  &:hover {\n    transform: rotate(15deg) scale(1.1);\n    border-color: var(--primary-hover);\n  }\n`;\n\nconst Username = styled.span`\n  font-weight: 700;\n  font-size: 1rem;\n  color: var(--text);\n  transition: var(--transition);\n  cursor: pointer;\n  position: relative;\n  \n  &::after {\n    content: '';\n    position: absolute;\n    bottom: -2px;\n    left: 0;\n    width: 0;\n    height: 2px;\n    background: var(--primary);\n    transition: width 0.3s;\n  }\n  \n  &:hover {\n    color: var(--primary);\n    \n    &::after {\n      width: 100%;\n    }\n  }\n`;\n\nconst ResponsiveImage = styled.img`\n  max-width: 100%;\n  max-height: 100%;\n  width: auto;\n  height: auto;\n  object-fit: contain;\n  transition: var(--transition);\n  border-radius: var(--radius-md);\n  \n  @media (max-width: 768px) {\n    object-fit: cover; /* Preenche o espa√ßo quadrado sem distorcer */\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n  \n  &:hover {\n    transform: scale(1.03);\n    filter: saturate(1.2) brightness(1.05);\n  }\n`;\n\nconst ResponsiveVideo = styled.video`\n  max-width: 100%;\n  max-height: 100%;\n  width: auto;\n  height: auto;\n  object-fit: contain;\n  border-radius: var(--radius-md);\n  z-index: 1;\n  transition: var(--transition);\n  \n  @media (max-width: 768px) {\n    object-fit: cover; /* Preenche o espa√ßo quadrado sem distorcer */\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n  \n  &:hover {\n    transform: scale(1.03);\n    filter: saturate(1.2) brightness(1.05);\n  }\n`;\n\nconst MediaContainer = styled.div`\n  width: 100%;\n  max-height: 43.75rem;\n  min-height: 18.75rem;\n  background: var(--background);\n  color: var(--text);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  position: relative;\n  overflow: hidden;\n\n  @media (max-width: 768px) {\n    width: 100%;\n    height: 100vw; /* Quadrado baseado na largura da tela */\n    max-height: 80vh; /* Limite m√°ximo opcional */\n  }\n`;\n\n\nconst VideoContainer = styled.div`\n  position: relative;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  cursor: pointer;\n  overflow: hidden;\n  border-radius: var(--radius-md);\n`;\n\nconst PlayButton = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  width: 5rem;\n  height: 5rem;\n  background: rgba(var(--primary-rgb), 0.8);\n  border-radius: 50%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 2;\n  transition: var(--transition);\n  backdrop-filter: blur(2px);\n  box-shadow: var(--shadow);\n  \n  &::before {\n    content: '';\n    position: absolute;\n    width: 0;\n    height: 0;\n    border-top: 0.9375rem solid transparent;\n    border-bottom: 0.9375rem solid transparent;\n    border-left: 1.5625rem solid var(--card-bg);\n    margin-left: 0.3125rem;\n  }\n  \n  &:hover {\n    background: rgba(var(--primary-rgb), 0.9);\n    transform: translate(-50%, -50%) scale(1.1);\n  }\n`;\n\nconst VideoControls = styled.div`\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  background: linear-gradient(to top, rgba(0,0,0,0.7), transparent);\n  padding: 0.625rem;\n  display: flex;\n  align-items: center;\n  z-index: 3;\n  opacity: 0;\n  transition: var(--transition);\n  \n  &:hover {\n    opacity: 1;\n    animation: ${fadeIn} 0.3s forwards;\n  }\n`;\n\nconst ControlButton = styled.button`\n  background: none;\n  border: none;\n  color: var(--card-bg);\n  font-size: 1.2rem;\n  margin: 0 0.3125rem;\n  cursor: pointer;\n  transition: var(--transition);\n  \n  &:hover {\n    color: var(--primary);\n    transform: scale(1.2);\n  }\n`;\n\nconst ProgressBar = styled.div`\n  flex-grow: 1;\n  height: 0.25rem;\n  background: rgba(255,255,255,0.3);\n  border-radius: 0.125rem;\n  margin: 0 0.625rem;\n  position: relative;\n  overflow: hidden;\n  cursor: pointer;\n`;\n\nconst Progress = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: ${props => props.$progress || '0%'};\n  background: var(--primary);\n  border-radius: 0.125rem;\n`;\n\nconst TimeDisplay = styled.span`\n  color: var(--card-bg);\n  font-size: 0.8rem;\n  min-width: 5rem;\n  text-align: center;\n`;\n\nconst Caption = styled.p`\n  padding: 1rem;\n  margin: 0;\n  font-size: 0.95rem;\n  line-height: 1.5;\n  color: var(--text);\n  background: var(--card-bg);\n  position: relative;\n  \n  &::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 0.25rem;\n    height: 100%;\n    background: linear-gradient(to bottom, var(--primary), var(--primary-hover));\n  }\n`;\n\nconst Tags = styled.div`\n  padding: 0 1rem 0.75rem;\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  background: var(--card-bg);\n`;\n\nconst Tag = styled.span`\n  color: var(--card-bg);\n  font-size: 0.85rem;\n  background: linear-gradient(45deg, var(--primary), var(--primary-hover));\n  padding: 0.375rem 0.75rem;\n  border-radius: 1.25rem;\n  transition: var(--transition);\n  text-shadow: 0 1px 2px rgba(0,0,0,0.2);\n  cursor: pointer;\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.05);\n    box-shadow: 0 4px 12px rgba(var(--primary-rgb), 0.3);\n  }\n`;\n\nconst Actions = styled.div`\n  display: flex;\n  padding: 0.75rem 1rem;\n  border-top: 1px solid var(--border-light);\n  background: var(--card-bg);\n  justify-content: space-between;\n`;\n\nconst ActionGroup = styled.div`\n  display: flex;\n  gap: 0.5rem;\n`;\n\nconst ActionButton = styled.button`\n  background: none;\n  border: none;\n  display: flex;\n  align-items: center;\n  color: ${props => props.$active ? props.$color || 'var(--primary)' : 'var(--text-light)'};\n  cursor: pointer;\n  font-size: 0.9rem;\n  padding: 0.5rem 1rem;\n  border-radius: var(--radius-sm);\n  transition: var(--transition);\n  position: relative;\n  overflow: hidden;\n  \n  svg {\n    margin-right: 0.375rem;\n    font-size: 1.2rem;\n    transition: var(--transition);\n  }\n\n  &:hover {\n    background: rgba(var(--primary-rgb), 0.05);\n    color: ${props => props.$color || 'var(--primary)'};\n    transform: translateY(-2px);\n    \n    svg {\n      transform: scale(1.2);\n    }\n  }\n  \n  &::after {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    background: rgba(255,255,255,0.2);\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    transition: var(--transition);\n  }\n  \n  &:hover::after {\n    width: 120%;\n    height: 120%;\n  }\n  \n  &:active {\n    transform: scale(0.95) translateY(-2px);\n  }\n`;\n\nconst RepostButton = styled(ActionButton)`\n  color: ${props => props.$active ? 'var(--success)' : 'var(--text-light)'};\n  \n  &:hover {\n    color: var(--success);\n  }\n`;\n\nconst ReactionAnimation = styled.div`\n  position: absolute;\n  animation: ${popIn} 0.5s forwards, ${pulse} 0.5s 0.5s forwards;\n  font-size: 2.5rem;\n  opacity: 0;\n  pointer-events: none;\n  filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));\n  text-shadow: 0 2px 4px rgba(0,0,0,0.3);\n  z-index: 10;\n`;\n\nconst MemeCard = ({ meme, isRepost = false, onDelete, onCommentCountChange, isFullScreen = false }) => {\n  const navigate = useNavigate();\n  const { user } = useAuth();\n  const [isLiked, setIsLiked] = useState(false);\n  const [likeCount, setLikeCount] = useState(meme.likes?.length || 0);\n  const [showComments, setShowComments] = useState(false);\n  const commentCount = meme.commentCount || 0;\n  const [reaction, setReaction] = useState(null);\n  const [isReposted, setIsReposted] = useState(false);\n  const [repostCount, setRepostCount] = useState(meme.repostCount || 0);\n  const [isCheckingRepost, setIsCheckingRepost] = useState(true);\n  const [showOptions, setShowOptions] = useState(false);\n  const [isDeleting, setIsDeleting] = useState(false);\n  const [showSuccess, setShowSuccess] = useState(false);\n  const [showConfirmDialog, setShowConfirmDialog] = useState(false);\n  const [deletionProgress, setDeletionProgress] = useState(0);\n  const [mentionMap, setMentionMap] = useState({});\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n  const [duration, setDuration] = useState(0);\n  const [currentTime, setCurrentTime] = useState(0);\n  const videoRef = useRef(null);\n  const commentSectionRef = useRef(null);\n  const touchStartY = useRef(null);\n  const [dragOffset, setDragOffset] = useState(0);\n  const [isDragging, setIsDragging] = useState(false);\n  const [dragStart, setDragStart] = useState(null);\n  const [currentDrag, setCurrentDrag] = useState(0);\n  const [shouldClose, setShouldClose] = useState(false);\n\n  useEffect(() => {\n    const processMentions = async () => {\n      if (meme.caption) {\n        try {\n          const result = await extractMentions(meme.caption);\n          setMentionMap(result.mentionMap || {});\n        } catch (error) {\n          console.error('Error processing mentions:', error);\n          setMentionMap({});\n        }\n      }\n    };\n    \n    processMentions();\n\n    if (user && meme.likes) {\n      setIsLiked(meme.likes.some(like => like.toString() === user._id));\n    }\n    setLikeCount(meme.likes?.length || 0);\n    setRepostCount(meme.repostCount || 0);\n    \n    if (user) {\n      checkIfReposted();\n    } else {\n      setIsCheckingRepost(false);\n    }\n  }, [meme, user]);\n\n  const handleDelete = async () => {\n    setShowConfirmDialog(false);\n    setIsDeleting(true);\n    \n    try {\n      const interval = setInterval(() => {\n        setDeletionProgress(prev => {\n          if (prev >= 90) {\n            clearInterval(interval);\n            return prev;\n          }\n          return prev + 10;\n        });\n      }, 100);\n\n      const token = localStorage.getItem('token');\n      const response = await api.delete(`/memes/${meme._id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      clearInterval(interval);\n      setDeletionProgress(100);\n\n      if (!response.data?.success) {\n        throw new Error(response.data?.message || 'Falha ao deletar');\n      }\n\n      setShowSuccess(true);\n      setTimeout(() => {\n        if (onDelete) onDelete(meme._id); \n        setShowSuccess(false);\n      }, 1500);\n\n    } catch (err) {\n      console.error('Erro ao deletar meme:', err);\n      \n      if (err.response?.status === 410) {\n        if (onDelete) onDelete(meme._id);\n        alert('Este meme j√° foi deletado anteriormente');\n      } else {\n        alert(err.response?.data?.message || 'Erro ao deletar meme');\n      }\n    } finally {\n      setIsDeleting(false);\n      setDeletionProgress(0);\n    }\n  };\n\n  const openDeleteConfirmation = () => {\n    setShowOptions(false);\n    setShowConfirmDialog(true);\n  };\n\n  const togglePlay = () => {\n    if (videoRef.current) {\n      if (isPlaying) {\n        videoRef.current.pause();\n      } else {\n        videoRef.current.play();\n      }\n      setIsPlaying(!isPlaying);\n    }\n  };\n\n  const handleTimeUpdate = () => {\n    if (videoRef.current) {\n      const currentProgress = (videoRef.current.currentTime / videoRef.current.duration) * 100;\n      setProgress(currentProgress);\n      setCurrentTime(videoRef.current.currentTime);\n    }\n  };\n\n  const handleLoadedMetadata = () => {\n    if (videoRef.current) {\n      setDuration(videoRef.current.duration);\n    }\n  };\n\n  const handleSeek = (e) => {\n    if (videoRef.current) {\n      const rect = e.target.getBoundingClientRect();\n      const pos = (e.clientX - rect.left) / rect.width;\n      videoRef.current.currentTime = pos * videoRef.current.duration;\n    }\n  };\n\n  const formatTime = (time) => {\n    const minutes = Math.floor(time / 60);\n    const seconds = Math.floor(time % 60);\n    return `${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;\n  };\n\n  const checkIfReposted = async () => {\n    try {\n      if (meme.originalMeme && meme.author._id === user._id) {\n        setIsReposted(true);\n      } else {\n        setIsReposted(meme.reposts?.some(repost => repost.toString() === user._id));\n      }\n    } catch (error) {\n      console.error('Erro ao verificar repost:', error);\n    } finally {\n      setIsCheckingRepost(false);\n    }\n  };\n\n  const handleLike = async () => {\n    if (!user) return;\n    \n    try {\n      const response = await api.post(`/memes/${meme._id}/like`);\n      setIsLiked(response.data.isLiked);\n      setLikeCount(response.data.likeCount);\n      setReaction(response.data.isLiked ? 'like' : 'dislike');\n      setTimeout(() => setReaction(null), 1500);\n    } catch (error) {\n      console.error('Erro ao curtir:', error);\n    }\n  };\n\n  const handleDislike = async () => {\n    if (!user || !isLiked) return;\n    \n    try {\n      const response = await api.post(`/memes/${meme._id}/like`);\n      setIsLiked(false);\n      setLikeCount(response.data.likeCount);\n      setReaction('dislike');\n      setTimeout(() => setReaction(null), 1500);\n    } catch (error) {\n      console.error('Erro ao remover curtida:', error);\n    }\n  };\n\n  const handleRepost = async () => {\n    if (!user) return;\n    \n    if (meme.author?._id === user._id) {\n      setReaction('self-repost');\n      setTimeout(() => setReaction(null), 1500);\n      return;\n    }\n    \n    if (isReposted || isRepost) return;\n\n    try {\n      const response = await api.post(`/memes/${meme._id}/repost`);\n      setIsReposted(true);\n      setRepostCount(response.data.repostCount);\n      \n      setReaction('repost');\n      setTimeout(() => setReaction(null), 1500);\n    } catch (error) {\n      console.error('Erro ao repostar:', error);\n      if (error.response && error.response.status === 409) {\n        setIsReposted(true);\n      }\n    }\n  };\n\n  const handleCommentSubmit = async (formData) => {\n    try {\n      const response = await api.post(\n        `/memes/${meme._id}/comments`,\n        formData,\n        {\n          headers: {\n            'Content-Type': 'multipart/form-data'\n          }\n        }\n      );\n  \n      const updatedMeme = await api.get(`/memes/${meme._id}`);\n      const commentCount = meme.commentCount || 0;\n      \n      return response.data;\n    } catch (error) {\n      console.error('Erro detalhado:', {\n        message: error.message,\n        response: error.response?.data,\n        status: error.response?.status,\n        config: error.config\n      });\n  \n      throw new Error(error.response?.data?.message || error.message || 'Erro ao enviar coment√°rio');\n    }\n  };\n\n  const buildUrl = (url) => {\n    if (!url) {\n      console.warn('URL is empty or undefined');\n      return 'https://i.pravatar.cc/150?img=3';\n    }\n  \n    if (url.startsWith('http://')) {\n      url = 'https://' + url.substring(7);\n    }\n    \n    if (url.startsWith('https://') || url.startsWith('blob:')) {\n      return url;\n    }\n  \n    const normalizedPath = url.startsWith('/') ? url : `/${url}`;\n    const apiUrl = process.env.REACT_APP_API_URL || 'https://api.jokesteronline.org';\n    const fullUrl = `${apiUrl}${normalizedPath}`;\n    \n    return fullUrl;\n  };\n\n  const toggleComments = () => {\n    setShowComments(!showComments);\n  };\n\n  const handleTouchStart = (e) => {\n    // Verificar se o toque come√ßou na √°rea de arraste superior\n    const touchY = e.touches[0].clientY;\n    const isHandleTouch = touchY < 100; // √Årea superior de 100px\n    \n    if (isHandleTouch && showComments) {\n      setDragStart(touchY);\n      setCurrentDrag(0);\n      setShouldClose(false);\n    }\n  };\n\n  const handleTouchMove = (e) => {\n    if (dragStart === null) return;\n    \n    const touchY = e.touches[0].clientY;\n    const deltaY = touchY - dragStart;\n    \n    // Limitar o arraste para baixo\n    if (deltaY > 0) {\n      setCurrentDrag(Math.min(deltaY, 300));\n      setShouldClose(deltaY > 100);\n      \n      // Bloquear a rolagem enquanto arrasta\n      if (commentSectionRef.current) {\n        commentSectionRef.current.style.overflow = 'hidden';\n      }\n    }\n  };\n\n  const handleTouchEnd = () => {\n    if (dragStart === null) return;\n    \n    if (shouldClose) {\n      setShowComments(false);\n    }\n    \n    // Resetar estados\n    setDragStart(null);\n    setCurrentDrag(0);\n    setShouldClose(false);\n    \n    // Restaurar a rolagem\n    if (commentSectionRef.current) {\n      commentSectionRef.current.style.overflow = 'auto';\n    }\n  };\n  useEffect(() => {\n    const element = commentSectionRef.current;\n    if (!element) return;\n\n    element.addEventListener('touchstart', handleTouchStart, { passive: false });\n    element.addEventListener('touchmove', handleTouchMove, { passive: false });\n    element.addEventListener('touchend', handleTouchEnd, { passive: false });\n\n    return () => {\n      element.removeEventListener('touchstart', handleTouchStart);\n      element.removeEventListener('touchmove', handleTouchMove);\n      element.removeEventListener('touchend', handleTouchEnd);\n    };\n  }, [showComments, dragStart, shouldClose]);\n\n\n  return (\n    <>\n      <Card $deleting={isDeleting}style={isFullScreen ? {\n        width: '100%',\n        height: '100%',\n        marginBottom: 0,\n        borderRadius: 0,\n        border: 'none',\n        boxShadow: 'none'\n      } : {}}>\n        {isDeleting && (\n          <div style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            background: 'rgba(0,0,0,0.5)',\n            zIndex: 5,\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center'\n          }}>\n            <div style={{\n              width: '80%',\n              background: 'rgba(255,255,255,0.2)',\n              borderRadius: '10px',\n              overflow: 'hidden'\n            }}>\n              <div style={{\n                width: `${deletionProgress}%`,\n                height: '6px',\n                background: 'var(--primary)',\n                transition: 'width 0.3s ease'\n              }} />\n            </div>\n          </div>\n        )}\n  \n        {showSuccess && (\n          <SuccessMessage>\n            <FaCheck size={18} />\n            <span>Meme deletado com sucesso!</span>\n          </SuccessMessage>\n        )}\n  \n        {user?._id === meme.author?._id && (\n          <div style={{ position: 'relative' }}>\n            <OptionsButton \n              onClick={(e) => {\n                e.stopPropagation();\n                setShowOptions(!showOptions);\n              }}\n            >\n              <FaEllipsisH size={14} />\n            </OptionsButton>\n  \n            {showOptions && (\n              <OptionsMenu onClick={(e) => e.stopPropagation()}>\n                <OptionItem onClick={openDeleteConfirmation}>\n                  <FiTrash2 size={14} />\n                  <span>Deletar</span>\n                </OptionItem>\n              </OptionsMenu>\n            )}\n          </div>\n        )}\n  \n        {isRepost && (\n          <RepostBadge>\n            <FiRepeat /> Repostado por @{meme.repostedBy?.username || 'usu√°rio'}\n          </RepostBadge>\n        )}\n        \n        {reaction && (\n          <ReactionAnimation style={{\n            top: '50%',\n            left: '50%',\n            transform: 'translate(-50%, -50%)',\n            color: reaction === 'like' ? 'var(--primary)' : \n                  reaction === 'dislike' ? '#f00' : \n                  reaction === 'repost' ? '#10b981' : 'var(--primary)'\n          }}>\n            {reaction === 'like' ? <FaSmile /> : \n             reaction === 'dislike' ? <FaAngry /> : \n             reaction === 'repost' ? <FaCheck /> : \n             <span style={{ fontSize: '1rem' }}>Voc√™ √© o autor!</span>}\n          </ReactionAnimation>\n        )}\n        \n        <Header>\n          <Avatar \n            src={\n              meme.author?.profile?.avatar\n                ? buildUrl(meme.author.profile.avatar)\n                : 'https://i.pravatar.cc/150?img=3'\n            }\n            alt={meme.author?.username}\n            onClick={() => meme.author && navigate(`/users/${meme.author._id}`)}\n            crossOrigin=\"anonymous\"\n            onError={(e) => {\n              e.target.src = 'https://i.pravatar.cc/150?img=3';\n            }}\n          />\n          <Username \n            onClick={() => meme.author && navigate(`/users/${meme.author._id}`)}\n          >\n            @{meme.author?.username || 'usu√°rio desconhecido'}\n          </Username>\n        </Header>\n        \n        <MediaContainer>\n          {meme.mediaType === 'image' ? (\n            <ResponsiveImage \n              src={buildUrl(meme.mediaUrl)}\n              alt={meme.caption || 'Meme image'}\n              style={{\n                transform: showComments ? 'scale(0.98)' : 'scale(1)',\n                filter: showComments ? 'brightness(0.95)' : 'none'\n              }}\n              crossOrigin=\"anonymous\"\n              onError={(e) => {\n                e.target.src = 'https://placehold.co/600x400?text=Imagem+n√£o+carregada';\n                e.target.onerror = null;\n              }}\n            />\n          ) : (\n            <VideoContainer onClick={togglePlay}>\n              <ResponsiveVideo\n                ref={videoRef}\n                src={buildUrl(meme.mediaUrl)}\n                preload=\"metadata\"\n                onTimeUpdate={handleTimeUpdate}\n                onLoadedMetadata={handleLoadedMetadata}\n                onEnded={() => setIsPlaying(false)}\n                crossOrigin=\"anonymous\"\n              />\n              \n              {!isPlaying && (\n                <PlayButton onClick={(e) => {\n                  e.stopPropagation();\n                  togglePlay();\n                }} />\n              )}\n              \n              <VideoControls onClick={(e) => e.stopPropagation()}>\n                <ControlButton onClick={togglePlay}>\n                  {isPlaying ? '‚ùö‚ùö' : '‚ñ∂'}\n                </ControlButton>\n                <ProgressBar onClick={handleSeek}>\n                  <Progress $progress={`${progress}%`} />\n                </ProgressBar>\n                <TimeDisplay>\n                  {formatTime(currentTime)} / {formatTime(duration)}\n                </TimeDisplay>\n                <ControlButton onClick={() => {\n                  if (videoRef.current) {\n                    videoRef.current.muted = !videoRef.current.muted;\n                  }\n                }}>\n                  {videoRef.current?.muted ? 'üîá' : 'üîà'}\n                </ControlButton>\n              </VideoControls>\n              \n              <div style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                right: 0,\n                bottom: 0,\n                background: `linear-gradient(45deg, \n                  rgba(255,255,255,0.1), \n                  rgba(255,69,0,0.05))`,\n                pointerEvents: 'none'\n              }}/>\n            </VideoContainer>\n          )}\n        </MediaContainer>\n  \n        {meme.caption && (\n          <Caption>\n            {React.Children.toArray(renderMentions(meme.caption, mentionMap, navigate))}\n          </Caption>\n        )}\n        \n        {meme.tags?.length > 0 && (\n          <Tags>\n            {meme.tags.map(tag => (\n              <Tag key={tag} onClick={() => navigate(`/explore?tag=${tag}`)}>#{tag}</Tag>\n            ))}\n          </Tags>\n        )}\n  \n        <Actions>\n          <ActionGroup>\n            <ActionButton \n              onClick={handleLike} \n              $active={isLiked}\n              $color=\"var(--primary)\"\n            >\n              <FaSmile /> {likeCount}\n            </ActionButton>\n            <ActionButton \n              onClick={handleDislike} \n              $active={!isLiked && likeCount > 0}\n              $color=\"var(--text)\"\n            >\n              <FaAngry /> \n            </ActionButton>\n            <ActionButton \n              onClick={toggleComments}\n              $active={showComments}\n              $color=\"#f000\"\n            >\n              <FiMessageSquare /> {commentCount}\n            </ActionButton>\n          </ActionGroup>\n          \n          <ActionGroup>\n            <RepostButton \n              onClick={handleRepost}\n              $active={isReposted}\n              disabled={isReposted || isCheckingRepost || isRepost || (meme.author?._id === user?._id)}\n              title={meme.author?._id === user?._id ? \"Voc√™ n√£o pode repostar seu pr√≥prio conte√∫do\" : \"\"}\n            >\n              {isCheckingRepost ? (\n                <FiRepeat />\n              ) : isReposted ? (\n                <FaCheck />\n              ) : (\n                <FiRepeat />\n              )} {repostCount}\n            </RepostButton>\n            <ActionButton>\n              <FiShare2 />\n            </ActionButton>\n          </ActionGroup>\n        </Actions>\n      </Card>\n  \n      {/* Se√ß√£o de coment√°rios mobile */}\n      {showComments && (\n        <>\n          <CommentOverlay \n            $visible={showComments}\n            onClick={toggleComments}\n          />\n\n          <ImprovedMobileCommentSection\n            $isOpen={showComments}\n            $offset={dragOffset}\n          >\n            <DragHandle \n              className=\"drag-handle\"\n              onTouchStart={handleTouchStart}\n              onTouchMove={handleTouchMove}\n              onTouchEnd={handleTouchEnd}\n            />\n            \n            <CommentSectionContainer\n              style={{\n                touchAction: isDragging ? 'none' : 'auto',\n                pointerEvents: isDragging ? 'none' : 'auto'\n                }}\n              ref={commentSectionRef}\n              onScroll={() => setIsDragging(false)}\n              onClick={(e) => e.stopPropagation()}\n            >\n              <CloseCommentsButton onClick={toggleComments}>\n                <FiChevronDown size={24} />\n              </CloseCommentsButton>\n              \n              <CommentSection \n                memeId={meme._id}\n                onCommentSubmit={handleCommentSubmit}\n                onCommentCountChange={onCommentCountChange} \n              />\n            </CommentSectionContainer>\n          </ImprovedMobileCommentSection>\n        </>\n      )}\n  \n      {showConfirmDialog && (\n        <ConfirmationDialog>\n          <DialogContent>\n            <DialogTitle>Tem certeza que deseja deletar este meme?</DialogTitle>\n            <p style={{ textAlign: 'center', color: 'var(--text-light)' }}>\n              Esta a√ß√£o √© irrevers√≠vel e remover√° o meme permanentemente.\n            </p>\n            <DialogButtons>\n              <DialogButton onClick={handleDelete}>\n                <FiCheck size={16} />\n                Confirmar\n              </DialogButton>\n              <DialogButton onClick={() => setShowConfirmDialog(false)}>\n                <FiX size={16} />\n                Cancelar\n              </DialogButton>\n            </DialogButtons>\n          </DialogContent>\n        </ConfirmationDialog>\n      )}\n    </>\n  );\n};\n\nexport default MemeCard;"],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,QAAQ,CAAEC,SAAS,CAAEC,MAAM,KAAQ,OAAO,CAC1D,MAAO,CAAAC,MAAM,EAAIC,SAAS,KAAQ,mBAAmB,CACrD,OAASC,eAAe,CAAEC,QAAQ,CAAEC,QAAQ,CAAEC,QAAQ,CAAEC,GAAG,CAAEC,OAAO,CAAEC,aAAa,KAAQ,gBAAgB,CAC3G,OAASC,OAAO,CAAEC,OAAO,CAAEC,OAAO,CAAEC,WAAW,KAAQ,gBAAgB,CACvE,MAAO,CAAAC,GAAG,KAAM,iBAAiB,CACjC,OAASC,OAAO,KAAQ,yBAAyB,CACjD,MAAO,CAAAC,cAAc,KAAM,kBAAkB,CAC7C,OAASC,WAAW,KAAQ,kBAAkB,CAC9C,OAASC,cAAc,KAAQ,yBAAyB,CACxD,OAASC,eAAe,KAAQ,uBAAuB,CAEvD;AAAA,OAAAC,GAAA,IAAAC,IAAA,CAAAC,IAAA,IAAAC,KAAA,CAAAC,QAAA,IAAAC,SAAA,yBACA,KAAM,CAAAC,KAAK,CAAGxB,SAAS;AACvB;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAyB,KAAK,CAAGzB,SAAS;AACvB;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA0B,QAAQ,CAAG1B,SAAS;AAC1B;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA2B,kBAAkB,CAAG3B,SAAS;AACpC;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA4B,MAAM,CAAG5B,SAAS;AACxB;AACA;AACA,CAAC,CAED,KAAM,CAAA6B,OAAO,CAAG7B,SAAS;AACzB;AACA;AACA,CAAC,CAED,KAAM,CAAA8B,SAAS,CAAG9B,SAAS;AAC3B;AACA;AACA,CAAC,CAED;AAEA,KAAM,CAAA+B,cAAc,CAAGhC,MAAM,CAACiC,GAAG;AACjC;AACA;AACA;AACA;AACA;AACA;AACA,aAAaC,KAAK,EAAIA,KAAK,CAACC,QAAQ,CAAG,CAAC,CAAG,CAAC;AAC5C;AACA,oBAAoBD,KAAK,EAAIA,KAAK,CAACC,QAAQ,CAAG,MAAM,CAAG,MAAM;AAC7D,CAAC,CAED,KAAM,CAAAC,oBAAoB,CAAGpC,MAAM,CAACiC,GAAG;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4BC,KAAK,EAAIA,KAAK,CAACG,OAAO,CAAG,GAAG,CAAG,MAAM;AACjE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED;AACA,KAAM,CAAAC,4BAA4B,CAAGtC,MAAM,CAACoC,oBAAoB,CAAC;AACjE;AACA,+BAA+BF,KAAK,EAAIA,KAAK,CAACK,OAAO,QAAQL,KAAK,EAAIA,KAAK,CAACG,OAAO,CAAG,IAAI,CAAG,MAAM;AACnG,aAAaH,KAAK,EAAI,CAAC,CAAIA,KAAK,CAACK,OAAO,CAAG,GAAI;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeL,KAAK,EAAI,CAAC,CAAIA,KAAK,CAACK,OAAO,CAAG,GAAI;AACjD;AACA,CAAC,CAED,KAAM,CAAAC,UAAU,CAAGxC,MAAM,CAACiC,GAAG;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAQ,uBAAuB,CAAGzC,MAAM,CAACiC,GAAG;AAC1C;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAS,oBAAoB,CAAG1C,MAAM,CAACiC,GAAG;AACvC;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAU,mBAAmB,CAAG3C,MAAM,CAAC4C,MAAM;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,mBAAmB,CAAG7C,MAAM,CAAC4C,MAAM;AACzC;AACA;AACA;AACA;AACA,WAAWV,KAAK,EAAIA,KAAK,CAACY,OAAO,CAAG,gBAAgB,CAAG,mBAAmB;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeC,IAAA,MAAC,CAAED,OAAQ,CAAC,CAAAC,IAAA,OAAM,CAAAD,OAAO,CAAG,CAAC,CAAG,CAAC,EAAC;AACjD;AACA;AACA,CAAC,CAED,KAAM,CAAAE,aAAa,CAAGhD,MAAM,CAAC4C,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAK,kBAAkB,CAAGjD,MAAM,CAACiC,GAAG;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeJ,MAAM;AACrB,CAAC,CAED,KAAM,CAAAqB,aAAa,CAAGlD,MAAM,CAACiC,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA,eAAeH,OAAO;AACtB,CAAC,CAED,KAAM,CAAAqB,WAAW,CAAGnD,MAAM,CAACoD,EAAE;AAC7B;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,aAAa,CAAGrD,MAAM,CAACiC,GAAG;AAChC;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAqB,YAAY,CAAGtD,MAAM,CAAC4C,MAAM;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAW,cAAc,CAAGvD,MAAM,CAACiC,GAAG;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeR,KAAK;AACpB;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA+B,WAAW,CAAGxD,MAAM,CAACiC,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAwB,UAAU,CAAGzD,MAAM,CAAC4C,MAAM;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAc,IAAI,CAAG1D,MAAM,CAACiC,GAAG;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAe0B,KAAA,MAAC,CAAEC,SAAU,CAAC,CAAAD,KAAA,OAAK,CAAAC,SAAS,CAAG,aAAa,CAAG,UAAU;AACxE,aAAaC,KAAA,MAAC,CAAED,SAAU,CAAC,CAAAC,KAAA,OAAK,CAAAD,SAAS,CAAG,GAAG,CAAG,CAAC;AACnD;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAE,WAAW,CAAG9D,MAAM,CAACiC,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAeN,QAAQ;AACvB;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAoC,MAAM,CAAG/D,MAAM,CAACiC,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA+B,MAAM,CAAGhE,MAAM,CAACiE,GAAG;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiBrC,kBAAkB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAsC,QAAQ,CAAGlE,MAAM,CAACmE,IAAI;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,eAAe,CAAGpE,MAAM,CAACiE,GAAG;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAI,eAAe,CAAGrE,MAAM,CAACsE,KAAK;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,cAAc,CAAGvE,MAAM,CAACiC,GAAG;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAGD,KAAM,CAAAuC,cAAc,CAAGxE,MAAM,CAACiC,GAAG;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAwC,UAAU,CAAGzE,MAAM,CAACiC,GAAG;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAyC,aAAa,CAAG1E,MAAM,CAACiC,GAAG;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiBJ,MAAM;AACvB;AACA,CAAC,CAED,KAAM,CAAA8C,aAAa,CAAG3E,MAAM,CAAC4C,MAAM;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAgC,WAAW,CAAG5E,MAAM,CAACiC,GAAG;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA4C,QAAQ,CAAG7E,MAAM,CAACiC,GAAG;AAC3B;AACA;AACA;AACA;AACA,WAAWC,KAAK,EAAIA,KAAK,CAAC4C,SAAS,EAAI,IAAI;AAC3C;AACA;AACA,CAAC,CAED,KAAM,CAAAC,WAAW,CAAG/E,MAAM,CAACmE,IAAI;AAC/B;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAa,OAAO,CAAGhF,MAAM,CAACiF,CAAC;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,IAAI,CAAGlF,MAAM,CAACiC,GAAG;AACvB;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAkD,GAAG,CAAGnF,MAAM,CAACmE,IAAI;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAiB,OAAO,CAAGpF,MAAM,CAACiC,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAoD,WAAW,CAAGrF,MAAM,CAACiC,GAAG;AAC9B;AACA;AACA,CAAC,CAED,KAAM,CAAAqD,YAAY,CAAGtF,MAAM,CAAC4C,MAAM;AAClC;AACA;AACA;AACA;AACA,WAAWV,KAAK,EAAIA,KAAK,CAACY,OAAO,CAAGZ,KAAK,CAACqD,MAAM,EAAI,gBAAgB,CAAG,mBAAmB;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAarD,KAAK,EAAIA,KAAK,CAACqD,MAAM,EAAI,gBAAgB;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAC,YAAY,CAAGxF,MAAM,CAACsF,YAAY,CAAC;AACzC,WAAWpD,KAAK,EAAIA,KAAK,CAACY,OAAO,CAAG,gBAAgB,CAAG,mBAAmB;AAC1E;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAA2C,iBAAiB,CAAGzF,MAAM,CAACiC,GAAG;AACpC;AACA,eAAeR,KAAK,mBAAmBC,KAAK;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,CAED,KAAM,CAAAgE,QAAQ,CAAGC,KAAA,EAAsF,KAAAC,WAAA,CAAAC,aAAA,CAAAC,gBAAA,CAAAC,aAAA,CAAAC,qBAA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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}