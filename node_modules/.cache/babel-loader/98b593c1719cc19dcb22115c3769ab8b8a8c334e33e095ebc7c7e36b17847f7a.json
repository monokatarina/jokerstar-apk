{"ast":null,"code":"// contexts/NotificationContext.jsx\nimport React,{createContext,useContext,useState,useEffect,useCallback}from'react';import api from'../services/api';import{useAuth}from'./AuthContext';import{initSocket}from'../services/socket';import{debounce}from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";const NotificationContext=/*#__PURE__*/createContext();export const NotificationProvider=_ref=>{let{children}=_ref;const[notifications,setNotifications]=useState([]);const[unreadCount,setUnreadCount]=useState(0);const[loading,setLoading]=useState(true);const{user}=useAuth();const[socket,setSocket]=useState(null);// Debounced version of setNotifications to prevent rapid updates\nconst setNotificationsDirectly=useCallback(newNotifications=>{setNotifications(newNotifications);},[]);// Carrega notificações iniciais\nconst loadNotifications=useCallback(async()=>{try{var _response$data;setLoading(true);const response=await api.get('/notifications',{params:{limit:20,skip:0,sort:'-createdAt'}});// Verifica a estrutura dos dados e atualiza o estado\nconst notificationsData=Array.isArray((_response$data=response.data)===null||_response$data===void 0?void 0:_response$data.data)?response.data.data:[];setNotificationsDirectly(notificationsData);}catch(error){console.error('Failed to load notifications:',error);setNotificationsDirectly([]);}finally{setLoading(false);}},[setNotificationsDirectly]);// Carrega contagem de não lidas\nconst loadUnreadCount=useCallback(async()=>{if(!user)return;try{const response=await api.get('/notifications/unread-count');setUnreadCount(response.data.count||0);}catch(error){console.error('Failed to load unread count:',error);setUnreadCount(0);}},[user]);// Marca notificações como lidas\nconst markAsRead=useCallback(async notificationIds=>{if(!notificationIds||notificationIds.length===0)return;try{await api.post('/notifications/mark-read',{notificationIds});setUnreadCount(prev=>Math.max(0,prev-notificationIds.length));setNotifications(prev=>prev.map(n=>notificationIds.includes(n._id)?{...n,read:true}:n));}catch(error){console.error('Failed to mark as read:',error);}},[]);// Limpa todas as notificações\nconst clearAllNotifications=useCallback(async()=>{try{await api.delete('/notifications');setNotifications([]);setUnreadCount(0);return true;}catch(error){console.error('Failed to clear notifications:',error);return false;}},[]);// Função para mostrar alerta de notificação\nconst showNotificationAlert=useCallback(notification=>{if('Notification'in window&&Notification.permission==='granted'){var _notification$sender,_notification$sender$;const title=getNotificationTitle(notification);const options={body:getNotificationBody(notification),icon:((_notification$sender=notification.sender)===null||_notification$sender===void 0?void 0:(_notification$sender$=_notification$sender.profile)===null||_notification$sender$===void 0?void 0:_notification$sender$.avatar)||'/logo192.png',badge:'/logo192.png'};// Fecha notificações anteriores para evitar acúmulo\nif(window.lastNotification){window.lastNotification.close();}window.lastNotification=new Notification(title,options);// Configura ação ao clicar na notificação\nwindow.lastNotification.onclick=()=>{window.focus();if(notification.meme){window.location.href=`/memes/${notification.meme._id}`;}else if(notification.comment){window.location.href=`/comments/${notification.comment._id}`;}else if(notification.reply){window.location.href=`/replies/${notification.reply._id}`;}};}},[]);// Handler para novas notificações via WebSocket\nconst handleNewNotification=useCallback(notification=>{console.log('Nova notificação recebida (antes do estado):',notification);setNotifications(prev=>{const newNotifications=[notification,...prev].slice(0,100);console.log('Notificações após atualização:',newNotifications);return newNotifications;});setUnreadCount(prev=>prev+1);if(document.visibilityState!=='visible'){showNotificationAlert(notification);}},[showNotificationAlert]);// Configura WebSocket e carrega dados iniciais\nuseEffect(()=>{if(!user){// Limpa notificações quando o usuário desloga\nsetNotifications([]);setUnreadCount(0);return;}// Solicita permissão para notificações\nif('Notification'in window&&Notification.permission!=='denied'){Notification.requestPermission();}// Inicializa o socket\nconst token=localStorage.getItem('token');const newSocket=initSocket(token);setSocket(newSocket);// Configura handlers de eventos\nnewSocket.on('connect_error',err=>{console.error('Connection error:',err);});newSocket.on('new-notification',handleNewNotification);// Carrega dados iniciais\nconst loadInitialData=async()=>{try{await Promise.all([loadNotifications(),loadUnreadCount()]);}catch(error){console.error('Error loading initial data:',error);}};loadInitialData();// Cleanup\nreturn()=>{if(newSocket){newSocket.off('new-notification',handleNewNotification);newSocket.disconnect();}};},[user,handleNewNotification,loadNotifications,loadUnreadCount]);// Funções auxiliares para texto de notificação\nconst getNotificationTitle=notification=>{var _notification$sender2,_notification$metadat,_notification$sender3,_notification$metadat2,_notification$sender4,_notification$sender5;switch(notification.type){case'like':return`${((_notification$sender2=notification.sender)===null||_notification$sender2===void 0?void 0:_notification$sender2.username)||'Alguém'} curtiu seu meme`;case'like_grouped':return`Seu meme tem ${((_notification$metadat=notification.metadata)===null||_notification$metadat===void 0?void 0:_notification$metadat.count)||'muitas'} curtidas`;case'comment':return`${((_notification$sender3=notification.sender)===null||_notification$sender3===void 0?void 0:_notification$sender3.username)||'Alguém'} comentou no seu meme`;case'comment_grouped':return`Seu meme tem ${((_notification$metadat2=notification.metadata)===null||_notification$metadat2===void 0?void 0:_notification$metadat2.count)||'muitos'} comentários`;case'reply':return`${((_notification$sender4=notification.sender)===null||_notification$sender4===void 0?void 0:_notification$sender4.username)||'Alguém'} respondeu seu comentário`;case'mention':return`${((_notification$sender5=notification.sender)===null||_notification$sender5===void 0?void 0:_notification$sender5.username)||'Alguém'} te mencionou`;default:return'Nova notificação';}};const getNotificationBody=notification=>{var _notification$meme,_notification$meme2,_notification$reply,_notification$comment;switch(notification.type){case'like':case'comment':return(_notification$meme=notification.meme)!==null&&_notification$meme!==void 0&&_notification$meme.caption?truncate(notification.meme.caption,50):'Veja agora';case'like_grouped':case'comment_grouped':return(_notification$meme2=notification.meme)!==null&&_notification$meme2!==void 0&&_notification$meme2.caption?truncate(notification.meme.caption,50):'Veja todas as interações';case'reply':return(_notification$reply=notification.reply)!==null&&_notification$reply!==void 0&&_notification$reply.text?truncate(notification.reply.text,50):'Veja a resposta';case'mention':return(_notification$comment=notification.comment)!==null&&_notification$comment!==void 0&&_notification$comment.text?truncate(notification.comment.text,50):'Veja a menção';default:return'';}};const truncate=(str,n)=>{return(str===null||str===void 0?void 0:str.length)>n?str.substr(0,n-1)+'...':str;};return/*#__PURE__*/_jsx(NotificationContext.Provider,{value:{notifications,unreadCount,loading,markAsRead,clearAllNotifications,loadNotifications,loadUnreadCount},children:children});};export const useNotifications=()=>{const context=useContext(NotificationContext);if(!context){throw new Error('useNotifications must be used within a NotificationProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","api","useAuth","initSocket","debounce","jsx","_jsx","NotificationContext","NotificationProvider","_ref","children","notifications","setNotifications","unreadCount","setUnreadCount","loading","setLoading","user","socket","setSocket","setNotificationsDirectly","newNotifications","loadNotifications","_response$data","response","get","params","limit","skip","sort","notificationsData","Array","isArray","data","error","console","loadUnreadCount","count","markAsRead","notificationIds","length","post","prev","Math","max","map","n","includes","_id","read","clearAllNotifications","delete","showNotificationAlert","notification","window","Notification","permission","_notification$sender","_notification$sender$","title","getNotificationTitle","options","body","getNotificationBody","icon","sender","profile","avatar","badge","lastNotification","close","onclick","focus","meme","location","href","comment","reply","handleNewNotification","log","slice","document","visibilityState","requestPermission","token","localStorage","getItem","newSocket","on","err","loadInitialData","Promise","all","off","disconnect","_notification$sender2","_notification$metadat","_notification$sender3","_notification$metadat2","_notification$sender4","_notification$sender5","type","username","metadata","_notification$meme","_notification$meme2","_notification$reply","_notification$comment","caption","truncate","text","str","substr","Provider","value","useNotifications","context","Error"],"sources":["C:/Users/drrod/OneDrive/Área de Trabalho/jokersta_apk/src/contexts/NotificationContext.jsx"],"sourcesContent":["// contexts/NotificationContext.jsx\r\nimport React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport api from '../services/api';\r\nimport { useAuth } from './AuthContext';\r\nimport { initSocket } from '../services/socket';\r\nimport { debounce } from 'lodash';\r\n\r\nconst NotificationContext = createContext();\r\n\r\nexport const NotificationProvider = ({ children }) => {\r\n  const [notifications, setNotifications] = useState([]);\r\n  const [unreadCount, setUnreadCount] = useState(0);\r\n  const [loading, setLoading] = useState(true);\r\n  const { user } = useAuth();\r\n  const [socket, setSocket] = useState(null);\r\n\r\n  // Debounced version of setNotifications to prevent rapid updates\r\n  const setNotificationsDirectly = useCallback((newNotifications) => {\r\n    setNotifications(newNotifications);\r\n  }, []);\r\n\r\n  // Carrega notificações iniciais\r\n  const loadNotifications = useCallback(async () => {\r\n    try {\r\n      setLoading(true);\r\n      const response = await api.get('/notifications', {\r\n        params: { limit: 20, skip: 0, sort: '-createdAt' }\r\n      });\r\n      \r\n      // Verifica a estrutura dos dados e atualiza o estado\r\n      const notificationsData = Array.isArray(response.data?.data) \r\n        ? response.data.data \r\n        : [];\r\n      \r\n      setNotificationsDirectly(notificationsData);\r\n    } catch (error) {\r\n      console.error('Failed to load notifications:', error);\r\n      setNotificationsDirectly([]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [setNotificationsDirectly]);\r\n\r\n  // Carrega contagem de não lidas\r\n  const loadUnreadCount = useCallback(async () => {\r\n    if (!user) return;\r\n    try {\r\n      const response = await api.get('/notifications/unread-count');\r\n      setUnreadCount(response.data.count || 0);\r\n    } catch (error) {\r\n      console.error('Failed to load unread count:', error);\r\n      setUnreadCount(0);\r\n    }\r\n  }, [user]);\r\n\r\n  // Marca notificações como lidas\r\n  const markAsRead = useCallback(async (notificationIds) => {\r\n    if (!notificationIds || notificationIds.length === 0) return;\r\n    try {\r\n      await api.post('/notifications/mark-read', { notificationIds });\r\n      setUnreadCount(prev => Math.max(0, prev - notificationIds.length));\r\n      setNotifications(prev => \r\n        prev.map(n => \r\n          notificationIds.includes(n._id) ? { ...n, read: true } : n\r\n        )\r\n      );\r\n    } catch (error) {\r\n      console.error('Failed to mark as read:', error);\r\n    }\r\n  }, []);\r\n\r\n  // Limpa todas as notificações\r\n  const clearAllNotifications = useCallback(async () => {\r\n    try {\r\n      await api.delete('/notifications');\r\n      setNotifications([]);\r\n      setUnreadCount(0);\r\n      return true;\r\n    } catch (error) {\r\n      console.error('Failed to clear notifications:', error);\r\n      return false;\r\n    }\r\n  }, []);\r\n\r\n  // Função para mostrar alerta de notificação\r\n  const showNotificationAlert = useCallback((notification) => {\r\n    if ('Notification' in window && Notification.permission === 'granted') {\r\n      const title = getNotificationTitle(notification);\r\n      const options = {\r\n        body: getNotificationBody(notification),\r\n        icon: notification.sender?.profile?.avatar || '/logo192.png',\r\n        badge: '/logo192.png'\r\n      };\r\n      \r\n      // Fecha notificações anteriores para evitar acúmulo\r\n      if (window.lastNotification) {\r\n        window.lastNotification.close();\r\n      }\r\n      \r\n      window.lastNotification = new Notification(title, options);\r\n      \r\n      // Configura ação ao clicar na notificação\r\n      window.lastNotification.onclick = () => {\r\n        window.focus();\r\n        if (notification.meme) {\r\n          window.location.href = `/memes/${notification.meme._id}`;\r\n        } else if (notification.comment) {\r\n          window.location.href = `/comments/${notification.comment._id}`;\r\n        } else if (notification.reply) {\r\n          window.location.href = `/replies/${notification.reply._id}`;\r\n        }\r\n      };\r\n    }\r\n  }, []);\r\n\r\n  // Handler para novas notificações via WebSocket\r\nconst handleNewNotification = useCallback((notification) => {\r\n  console.log('Nova notificação recebida (antes do estado):', notification);\r\n  \r\n  setNotifications(prev => {\r\n    const newNotifications = [notification, ...prev].slice(0, 100);\r\n    console.log('Notificações após atualização:', newNotifications);\r\n    return newNotifications;\r\n  });\r\n  \r\n  setUnreadCount(prev => prev + 1);\r\n  \r\n  if (document.visibilityState !== 'visible') {\r\n    showNotificationAlert(notification);\r\n  }\r\n}, [showNotificationAlert]);\r\n\r\n  // Configura WebSocket e carrega dados iniciais\r\n  useEffect(() => {\r\n    if (!user) {\r\n      // Limpa notificações quando o usuário desloga\r\n      setNotifications([]);\r\n      setUnreadCount(0);\r\n      return;\r\n    }\r\n\r\n    // Solicita permissão para notificações\r\n    if ('Notification' in window && Notification.permission !== 'denied') {\r\n      Notification.requestPermission();\r\n    }\r\n\r\n    // Inicializa o socket\r\n    const token = localStorage.getItem('token');\r\n    const newSocket = initSocket(token);\r\n    setSocket(newSocket);\r\n\r\n    // Configura handlers de eventos\r\n    newSocket.on('connect_error', (err) => {\r\n      console.error('Connection error:', err);\r\n    });\r\n\r\n    newSocket.on('new-notification', handleNewNotification);\r\n\r\n    // Carrega dados iniciais\r\n    const loadInitialData = async () => {\r\n      try {\r\n        await Promise.all([loadNotifications(), loadUnreadCount()]);\r\n      } catch (error) {\r\n        console.error('Error loading initial data:', error);\r\n      }\r\n    };\r\n    \r\n    loadInitialData();\r\n\r\n    // Cleanup\r\n    return () => {\r\n      if (newSocket) {\r\n        newSocket.off('new-notification', handleNewNotification);\r\n        newSocket.disconnect();\r\n      }\r\n    };\r\n  }, [user, handleNewNotification, loadNotifications, loadUnreadCount]);\r\n\r\n  // Funções auxiliares para texto de notificação\r\n  const getNotificationTitle = (notification) => {\r\n    switch(notification.type) {\r\n      case 'like':\r\n        return `${notification.sender?.username || 'Alguém'} curtiu seu meme`;\r\n      case 'like_grouped':\r\n        return `Seu meme tem ${notification.metadata?.count || 'muitas'} curtidas`;\r\n      case 'comment':\r\n        return `${notification.sender?.username || 'Alguém'} comentou no seu meme`;\r\n      case 'comment_grouped':\r\n        return `Seu meme tem ${notification.metadata?.count || 'muitos'} comentários`;\r\n      case 'reply':\r\n        return `${notification.sender?.username || 'Alguém'} respondeu seu comentário`;\r\n      case 'mention':\r\n        return `${notification.sender?.username || 'Alguém'} te mencionou`;\r\n      default:\r\n        return 'Nova notificação';\r\n    }\r\n  };\r\n  \r\n  const getNotificationBody = (notification) => {\r\n    switch(notification.type) {\r\n      case 'like':\r\n      case 'comment':\r\n        return notification.meme?.caption \r\n          ? truncate(notification.meme.caption, 50) \r\n          : 'Veja agora';\r\n      case 'like_grouped':\r\n      case 'comment_grouped':\r\n        return notification.meme?.caption \r\n          ? truncate(notification.meme.caption, 50) \r\n          : 'Veja todas as interações';\r\n      case 'reply':\r\n        return notification.reply?.text \r\n          ? truncate(notification.reply.text, 50) \r\n          : 'Veja a resposta';\r\n      case 'mention':\r\n        return notification.comment?.text \r\n          ? truncate(notification.comment.text, 50) \r\n          : 'Veja a menção';\r\n      default:\r\n        return '';\r\n    }\r\n  };\r\n\r\n  const truncate = (str, n) => {\r\n    return str?.length > n ? str.substr(0, n-1) + '...' : str;\r\n  };\r\n\r\n  return (\r\n    <NotificationContext.Provider\r\n      value={{\r\n        notifications,\r\n        unreadCount,\r\n        loading,\r\n        markAsRead,\r\n        clearAllNotifications,\r\n        loadNotifications,\r\n        loadUnreadCount\r\n      }}\r\n    >\r\n      {children}\r\n    </NotificationContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useNotifications = () => {\r\n  const context = useContext(NotificationContext);\r\n  if (!context) {\r\n    throw new Error('useNotifications must be used within a NotificationProvider');\r\n  }\r\n  return context;\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}