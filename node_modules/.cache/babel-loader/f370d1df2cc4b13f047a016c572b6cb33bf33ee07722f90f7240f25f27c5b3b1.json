{"ast":null,"code":"// components/MentionInput.jsx\nimport React,{useState,useRef}from'react';import styled from'styled-components';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MentionInput=_ref=>{let{value,onChange}=_ref;const[showSuggestions,setShowSuggestions]=useState(false);const[suggestions,setSuggestions]=useState([]);const[mentionQuery,setMentionQuery]=useState('');const inputRef=useRef(null);// Detecta quando o usuário digita @\nconst handleInputChange=e=>{const text=e.target.value;onChange(text);const lastAtPos=text.lastIndexOf('@');if(lastAtPos>=0){const query=text.substring(lastAtPos+1);setMentionQuery(query);if(query.length>0){fetchMentions(query);setShowSuggestions(true);}else{setShowSuggestions(false);}}else{setShowSuggestions(false);}};// Busca usuários para sugestões\nconst fetchMentions=async query=>{try{const response=await api.get(`/users/search?q=${query}`);setSuggestions(response.data);}catch(error){console.error('Error fetching mentions:',error);}};// Insere a menção no texto\nconst selectMention=username=>{const text=value;const lastAtPos=text.lastIndexOf('@');const newText=`${text.substring(0,lastAtPos)}@${username} ${text.substring(lastAtPos+mentionQuery.length+1)}`;onChange(newText);setShowSuggestions(false);inputRef.current.focus();};return/*#__PURE__*/_jsxs(InputContainer,{children:[/*#__PURE__*/_jsx(StyledTextarea,{ref:inputRef,value:value,onChange:handleInputChange,placeholder:\"Escreva um coment\\xE1rio...\"}),showSuggestions&&/*#__PURE__*/_jsx(SuggestionsList,{children:suggestions.map(user=>/*#__PURE__*/_jsxs(SuggestionItem,{onClick:()=>selectMention(user.username),children:[/*#__PURE__*/_jsx(Avatar,{src:user.profile.avatar}),/*#__PURE__*/_jsx(\"span\",{children:user.username})]},user._id))})]});};// Estilos omitidos por brevidade (usar styled-components)","map":{"version":3,"names":["React","useState","useRef","styled","jsx","_jsx","jsxs","_jsxs","MentionInput","_ref","value","onChange","showSuggestions","setShowSuggestions","suggestions","setSuggestions","mentionQuery","setMentionQuery","inputRef","handleInputChange","e","text","target","lastAtPos","lastIndexOf","query","substring","length","fetchMentions","response","api","get","data","error","console","selectMention","username","newText","current","focus","InputContainer","children","StyledTextarea","ref","placeholder","SuggestionsList","map","user","SuggestionItem","onClick","Avatar","src","profile","avatar","_id"],"sources":["C:/Users/drrod/OneDrive/Área de Trabalho/client2/src/components/MentionInput.jsx"],"sourcesContent":["// components/MentionInput.jsx\r\nimport React, { useState, useRef } from 'react';\r\nimport styled from 'styled-components';\r\n\r\nconst MentionInput = ({ value, onChange }) => {\r\n  const [showSuggestions, setShowSuggestions] = useState(false);\r\n  const [suggestions, setSuggestions] = useState([]);\r\n  const [mentionQuery, setMentionQuery] = useState('');\r\n  const inputRef = useRef(null);\r\n\r\n  // Detecta quando o usuário digita @\r\n  const handleInputChange = (e) => {\r\n    const text = e.target.value;\r\n    onChange(text);\r\n\r\n    const lastAtPos = text.lastIndexOf('@');\r\n    if (lastAtPos >= 0) {\r\n      const query = text.substring(lastAtPos + 1);\r\n      setMentionQuery(query);\r\n      if (query.length > 0) {\r\n        fetchMentions(query);\r\n        setShowSuggestions(true);\r\n      } else {\r\n        setShowSuggestions(false);\r\n      }\r\n    } else {\r\n      setShowSuggestions(false);\r\n    }\r\n  };\r\n\r\n  // Busca usuários para sugestões\r\n  const fetchMentions = async (query) => {\r\n    try {\r\n      const response = await api.get(`/users/search?q=${query}`);\r\n      setSuggestions(response.data);\r\n    } catch (error) {\r\n      console.error('Error fetching mentions:', error);\r\n    }\r\n  };\r\n\r\n  // Insere a menção no texto\r\n  const selectMention = (username) => {\r\n    const text = value;\r\n    const lastAtPos = text.lastIndexOf('@');\r\n    const newText = `${text.substring(0, lastAtPos)}@${username} ${text.substring(lastAtPos + mentionQuery.length + 1)}`;\r\n    onChange(newText);\r\n    setShowSuggestions(false);\r\n    inputRef.current.focus();\r\n  };\r\n\r\n  return (\r\n    <InputContainer>\r\n      <StyledTextarea\r\n        ref={inputRef}\r\n        value={value}\r\n        onChange={handleInputChange}\r\n        placeholder=\"Escreva um comentário...\"\r\n      />\r\n      {showSuggestions && (\r\n        <SuggestionsList>\r\n          {suggestions.map(user => (\r\n            <SuggestionItem \r\n              key={user._id} \r\n              onClick={() => selectMention(user.username)}\r\n            >\r\n              <Avatar src={user.profile.avatar} />\r\n              <span>{user.username}</span>\r\n            </SuggestionItem>\r\n          ))}\r\n        </SuggestionsList>\r\n      )}\r\n    </InputContainer>\r\n  );\r\n};\r\n\r\n// Estilos omitidos por brevidade (usar styled-components)"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}